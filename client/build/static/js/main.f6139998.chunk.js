(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{150:function(e,t,n){"use strict";n.r(t);n(74);var r=n(35),a=n.n(r),c=n(9),s=n(25),i=n(72),o=n(3),u=n(11),l=n(5),d=n(1),p=n(2),j=n.n(p),h=n(4),b=n(10),m=n.n(b),f="FETCH_STORIES",O="FETCH_USER",x="POST_STORY",v="UPDATE_USER",y="UPDATING_USERNAME",g="UPDATING_DESCRIPTION",N="FETCH_STORY",S="FETCH_STORY_REQUEST",E="FETCH_AUTHOR",w="FETCH_AUTHOR_BASIC",k="UPDATE_STORY_COMMENTS",T="POST_SNIPPET",C="FETCH_SNIPPETS",_="PAGINATE",P="DELETE_SNIPPET",A="EDIT_STORY",L="CLEAN_UP",R="FETCH_USER_STORIES",I="ADD_ERROR",D="DELETE_USER",U="CLEAR_MESSAGE",q="ADD_MESSAGE",M="DELETE_COMMENT",H="PAYMENT_SUCCESS",Y="DROP_NAV",B="UNDROP_NAV",F="LOADING",G="CLEAR_STORIES",z="CLEAR_ERROR",X="CLEAR_AUTHOR",W="CLEAR_STORY",V="CLEAR_SNIPPETS",K="CLEAR_USER_STORIES",J="CLEAR_PAGINATION",Q=function(e,t){return function(){var n=Object(h.a)(j.a.mark((function n(r){var a;return j.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,m.a.get("/api/account/stories/".concat(t,"/?page=").concat(e));case 2:a=n.sent,r({type:R,payload:a.data.stories}),r({type:_,payload:a.data.pager});case 5:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},Z=function(){return function(){var e=Object(h.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,m.a.get("/api/current_user");case 3:n=e.sent,t({type:O,payload:n.data}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()},$=function(e){return function(){var t=Object(h.a)(j.a.mark((function t(n){var r,a;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,m.a.get("/api/stories/".concat(e));case 3:(r=t.sent).data.story.comments>0&&(r.data.story.comments=r.data.story.comments.reverse()),n({type:N,payload:r.data.story}),t.next=13;break;case 8:t.prev=8,t.t0=t.catch(0),a={statusCode:t.t0.response.status,message:t.t0.response.data.error,statusText:t.t0.response.data.statusText},console.log(a),n({type:I,payload:a});case 13:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e){return t.apply(this,arguments)}}()},ee=function(e){return function(){var t=Object(h.a)(j.a.mark((function t(n){var r;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,m.a.get("/account/".concat(e));case 2:r=t.sent,n({type:E,payload:r.data});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},te=function(e){return function(){var t=Object(h.a)(j.a.mark((function t(n){var r,a;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,m.a.get("/account/basic/".concat(e));case 3:r=t.sent,n({type:w,payload:r.data}),t.next=11;break;case 7:t.prev=7,t.t0=t.catch(0),a={statusCode:t.t0.response.status,message:t.t0.response.data.error,statusText:t.t0.response.data.statusText},n({type:I,payload:a});case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()},ne=function(e){return function(){var t=Object(h.a)(j.a.mark((function t(n){var r;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,m.a.post("/api/post-snippet",{snippetText:e});case 3:t.next=9;break;case 5:t.prev=5,t.t0=t.catch(0),r={statusCode:t.t0.response.status,message:t.t0.response.data.error,statusText:t.t0.response.data.statusText},n({type:I,payload:r});case 9:case"end":return t.stop()}}),t,null,[[0,5]])})));return function(e){return t.apply(this,arguments)}}()},re=function(e){return function(){var t=Object(h.a)(j.a.mark((function t(n){return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,m.a.delete("/api/snippet/"+e);case 2:n({type:P,payload:e});case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},ae=function(e){return{type:T,payload:e}},ce=function(e){return e?{type:Y}:e?void 0:{type:B}},se=function(){return{type:U}},ie=function(){return{type:z}},oe=function(){return{type:G}},ue=function(){return{type:X}},le=function(){return{type:V}},de=function(){return{type:K}},pe=function(){return{type:J}},je=n(0),he=Object(c.b)((function(e){return{auth:e.auth,navStatus:e.navStatus}}),{fetchUser:Z,logout:function(){return function(){var e=Object(h.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.get("/api/logout");case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},dropNav:ce,clearStories:oe})((function(e){var t=e.fetchUser,n=e.auth,r=e.logout,a=e.navStatus,c=e.dropNav,s=e.clearStories,i=Object(d.useState)(!1),u=Object(l.a)(i,2);u[0],u[1];Object(d.useEffect)((function(){t()}),[t]);return Object(je.jsx)("nav",{children:Object(je.jsxs)("div",{className:"header",children:[Object(je.jsx)("div",{className:"header-left",children:Object(je.jsx)(o.b,{to:"/",onClick:function(){return s()},children:Object(je.jsx)("h2",{children:"Writer's Desk"})})}),Object(je.jsx)("div",{className:"header-right",children:n?(null===n||void 0===n?void 0:n._id)?Object(je.jsxs)("div",{children:[Object(je.jsxs)("div",{className:"header-right-menu ".concat(a&&"active"),children:[Object(je.jsx)(o.b,{to:"/add-story",className:" btn dd-btn",onClick:function(){return c(!1)},children:"Add a Story"}),Object(je.jsx)(o.b,{to:"/your-profile",className:" btn dd-btn",onClick:function(){return c(!1)},children:"Your Profile"}),Object(je.jsx)("a",{href:"/api/logout",className:"btn dd-btn",onClick:function(){c(!1),r()},children:"Log Out"})]}),Object(je.jsx)("div",{className:"burger ".concat(a&&"active"),children:Object(je.jsxs)("button",{onClick:function(){return c(!a)},className:"burger-btn",children:[Object(je.jsx)("div",{className:"burger-line"}),Object(je.jsx)("div",{className:"burger-line"}),Object(je.jsx)("div",{className:"burger-line"})]})})]}):null:Object(je.jsx)("div",{className:"google-btn ".concat(c&&"active"),children:Object(je.jsx)("a",{"google-btn-link":!0,href:"/auth/google",children:Object(je.jsxs)("button",{type:"button",className:"google-button",children:[Object(je.jsx)("span",{className:"google-button__icon",children:Object(je.jsxs)("svg",{viewBox:"0 0 366 372",xmlns:"http://www.w3.org/2000/svg",children:[Object(je.jsx)("path",{d:"M125.9 10.2c40.2-13.9 85.3-13.6 125.3 1.1 22.2 8.2 42.5 21 59.9 37.1-5.8 6.3-12.1 12.2-18.1 18.3l-34.2 34.2c-11.3-10.8-25.1-19-40.1-23.6-17.6-5.3-36.6-6.1-54.6-2.2-21 4.5-40.5 15.5-55.6 30.9-12.2 12.3-21.4 27.5-27 43.9-20.3-15.8-40.6-31.5-61-47.3 21.5-43 60.1-76.9 105.4-92.4z",id:"Shape",fill:"#EA4335"}),Object(je.jsx)("path",{d:"M20.6 102.4c20.3 15.8 40.6 31.5 61 47.3-8 23.3-8 49.2 0 72.4-20.3 15.8-40.6 31.6-60.9 47.3C1.9 232.7-3.8 189.6 4.4 149.2c3.3-16.2 8.7-32 16.2-46.8z",id:"Shape",fill:"#FBBC05"}),Object(je.jsx)("path",{d:"M361.7 151.1c5.8 32.7 4.5 66.8-4.7 98.8-8.5 29.3-24.6 56.5-47.1 77.2l-59.1-45.9c19.5-13.1 33.3-34.3 37.2-57.5H186.6c.1-24.2.1-48.4.1-72.6h175z",id:"Shape",fill:"#4285F4"}),Object(je.jsx)("path",{d:"M81.4 222.2c7.8 22.9 22.8 43.2 42.6 57.1 12.4 8.7 26.6 14.9 41.4 17.9 14.6 3 29.7 2.6 44.4.1 14.6-2.6 28.7-7.9 41-16.2l59.1 45.9c-21.3 19.7-48 33.1-76.2 39.6-31.2 7.1-64.2 7.3-95.2-1-24.6-6.5-47.7-18.2-67.6-34.1-20.9-16.6-38.3-38-50.4-62 20.3-15.7 40.6-31.5 60.9-47.3z",fill:"#34A853"})]})}),Object(je.jsx)("span",{className:"google-button__text",children:"Sign in with Google"})]})})})})]})})}));function be(){var e=Object(u.e)().pathname;return Object(d.useEffect)((function(){window.scrollTo(0,0)}),[e]),null}var me=n(7),fe=function(e,t){return Object(je.jsxs)("div",{className:"error-container",children:[Object(je.jsxs)("p",{children:["Error:",e.statusCode]}),Object(je.jsx)("p",{children:e.message}),Object(je.jsx)(o.b,{className:"btn",to:"/",onClick:function(){t()},children:"Back to Home"})]})},Oe=n(23),xe=n.n(Oe),ve=n(37),ye=n.n(ve),ge=n(15),Ne=Object(c.b)((function(e){return{snippets:e.snippets,auth:e.auth}}),{postSnippet:ne,fetchSnippet:function(){return function(){var e=Object(h.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.get("/api/snippets");case 2:n=e.sent,t({type:C,payload:n.data.snippets});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},addSnippet:ae,deleteSnippet:re,clearError:ie,clearAuthor:ue,clearSnippets:le})((function(e){var t=e.postSnippet,n=e.fetchSnippet,r=e.snippets,a=e.addSnippet,c=e.auth,s=e.deleteSnippet,i=e.clearAuthor,u=e.clearSnippets,l=Object(ge.a)(),p=l.register,j=l.handleSubmit,h=l.errors,b=l.reset;Object(d.useEffect)((function(){var e=ye()("https://writers-desk.herokuapp.com");return e.on("snippets",(function(e){"create"===e.action&&a(e.snippet),"delete"===e.action&&n()})),function(){e.off("snippets")}}),[a,n,r.length]),Object(d.useEffect)((function(){r.length<1&&n()}),[]),Object(d.useEffect)((function(){return function(){u()}}),[]);var m=function(e){t(e.snippetText),b()};return Object(je.jsx)("div",{children:Object(je.jsxs)("div",{className:"snippets-container story-item",children:[Object(je.jsx)("div",{className:"snippet-header-container",children:Object(je.jsx)("h3",{children:"Snippets"})}),Object(je.jsx)("p",{className:"snippets-sub-header",children:"Let other writers know what you're up to, add a short snippet to the live feed."}),Object(je.jsxs)("form",{className:"snippet-form",onSubmit:j(m),children:[Object(je.jsx)("label",{children:"Post a snippet"}),Object(je.jsxs)("div",{className:"input-container",children:[Object(je.jsx)("input",{name:"snippetText",ref:p({required:!0,maxLength:100}),className:"snippets-home-input"}),Object(je.jsx)("div",{className:"snippet-btn-container",children:Object(je.jsx)("button",{className:"btn green-btn",type:"submit",children:"Post"})})]}),h.snippetText&&"maxLength"===h.snippetText.type&&Object(je.jsx)("p",{className:"validation-warning",children:"Snippets have a max length of 100 characters"})]}),(r.length>10?r.slice(0,10):r).map((function(e){return Object(je.jsxs)("div",{className:"snippet-container",children:[Object(je.jsxs)("div",{className:"snippet-left",children:[Object(je.jsx)("p",{className:"snippet-text",children:e.text}),Object(je.jsx)("p",{className:"snippet-username",children:Object(je.jsx)(o.b,{to:"/author/".concat(e._user),onClick:function(){return i()},children:e.username})})]}),Object(je.jsx)("div",{className:"snippet-right",children:e._user===(null===c||void 0===c?void 0:c._id)?Object(je.jsx)("button",{className:"btn delete-btn",onClick:function(){return s(e._id)},children:"Delete"}):null})]},e._id)})),Object(je.jsx)("div",{className:"link-to-snippets",children:Object(je.jsx)(o.b,{to:"/snippets/1",children:"See all snippets"})})]})})})),Se=function(e){var t=e.pager,n=e.currentPage,r=e.path,a=e.clearStore;return Object(je.jsx)("div",{className:"paginate-container",children:Object(je.jsxs)("ul",{children:[1!==t.currentPage&&1!==t.previousPage?Object(je.jsx)("li",{children:Object(je.jsx)(o.b,{to:"".concat(r,"1"),className:"".concat(1===n&&"active"," "),onClick:function(){return a()},children:"1"})}):null,t.hasPreviousPage?Object(je.jsx)("li",{children:Object(je.jsx)(o.b,{to:"".concat(r).concat(t.previousPage),onClick:function(){return a()},children:t.previousPage})}):null,Object(je.jsx)("li",{children:Object(je.jsx)(o.b,{to:"".concat(r).concat(t.currentPage),className:"active",onClick:function(){return a()},children:t.currentPage})}),t.hasNextPage?Object(je.jsx)("li",{children:Object(je.jsx)(o.b,{to:"".concat(r).concat(t.nextPage),onClick:function(){return a()},children:t.nextPage})}):null,t.lastPage!==t.currentPage&&t.nextPage!==t.lastPage&&0!==t.lastPage?Object(je.jsx)("li",{children:Object(je.jsx)(o.b,{to:"".concat(r).concat(t.lastPage),onClick:function(){return a()},children:t.lastPage})}):null]})})},Ee=Object(c.b)((function(e){return{stories:e.stories,pager:e.pager,error:e.error,message:e.message,loading:e.loading,storeStory:e.story}}),{fetchStories:function(e){return function(){var t=Object(h.a)(j.a.mark((function t(n){var r;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,m.a.get("/api/stories/?page="+e);case 2:r=t.sent,n({type:_,payload:r.data.pager}),n({type:f,payload:r.data.stories});case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},clearError:ie,clearMessage:se,clearStory:function(){return{type:W}},clearAuthor:ue,clearStories:oe,dropNav:ce,clearPagination:pe})((function(e){var t=e.stories,n=e.fetchStories,r=e.pager,a=e.match,c=e.clearMessage,s=e.error,i=e.message,u=e.clearError,p=e.storeStory,j=e.clearStory,h=e.clearAuthor,b=e.clearStories,m=e.dropNav,f=e.clearPagination,O=Object(d.useState)(a.params.page),x=Object(l.a)(O,2),v=x[0],y=x[1],g=Object(d.useState)(!0),N=Object(l.a)(g,2),S=N[0],E=N[1];Object(d.useEffect)((function(){y(a.params.page||1)}),[y,a.params.page,v]),Object(d.useEffect)((function(){t.length<1&&n(v||1)}),[v]),Object(d.useEffect)((function(){t.length>0&&E(!1),t.length<1&&E(!0)}),[t]),Object(d.useEffect)((function(){return function(){u()}}),[u]),Object(d.useEffect)((function(){return function(){c()}}),[c]),Object(d.useEffect)((function(){return function(){m(!1)}}),[m]),Object(d.useEffect)((function(){return function(){b(),f()}}),[]);var w=function(e,t){t&&e!==t&&(j(),h())},k=function(){return function(){var e={},n=Object(me.a)(t);return n.splice(0,0,e),n.splice(1,0,e),n.splice(2,0,e),n}().map((function(e,t){return 0===t?Object(je.jsx)("div",{className:"story-item-container",children:Object(je.jsx)(o.b,{to:"/story/606ae0b59dbfba3cccf41568",onClick:function(){return w(e._id,null===p||void 0===p?void 0:p._id)},children:Object(je.jsxs)("div",{className:"story-item featured-story",children:[Object(je.jsx)("h5",{className:"featured-text",children:"Featured Story"}),Object(je.jsx)("h3",{children:"Shall I compare thee to a summer's day?"}),Object(je.jsx)("p",{className:"story-page-author",children:"Posted by: Somebody"}),Object(je.jsx)("p",{className:"story-page-desc",children:"A poem I wrote back in February about better days to come! Kinda sombre in theme as well but don't let it get you down too much! A poem I wrote back in February about better days to come! Kinda sombre in theme as well but don't"})]})})},t):1===t?Object(je.jsx)("div",{className:"story-item-container snippets-container",children:Object(je.jsx)(Ne,{})},t):2===t?Object(je.jsx)("div",{className:"story-item-container sub-header-container",children:Object(je.jsx)("h2",{children:"Latest Stories"})},t):Object(je.jsx)("div",{className:"story-item-container",children:Object(je.jsx)(o.b,{to:"/story/".concat(e._id),onClick:function(){return w(e._id,null===p||void 0===p?void 0:p._id)},children:Object(je.jsxs)("div",{className:"story-item",children:[Object(je.jsx)("h3",{children:e.title}),Object(je.jsxs)("p",{className:"story-page-author",children:["Posted by: ",e.username]}),Object(je.jsx)("p",{className:"story-page-desc",children:e.description})]})})},t)}))};return Object(je.jsxs)("div",{children:[function(){if(i)return Object(je.jsx)("div",{className:"message-container",children:Object(je.jsxs)("div",{className:"message",children:[Object(je.jsx)("p",{children:i}),Object(je.jsx)("button",{className:"btn notification-btn",onClick:function(){return c()},children:"Close"})]})})}(),s?fe(s,u):Object(je.jsxs)("div",{className:"stories-container",children:[Object(je.jsx)("div",{className:"header-container",children:Object(je.jsx)("h1",{children:v&&1!=v?"Latest Stories - Page ".concat(v):"Home"})}),Object(je.jsxs)("p",{className:"p-welcome",children:["Welcome to ",Object(je.jsx)("span",{children:"Writer's Desk"}),", a space for creative writers to share their work! Sign up and post your own stories and consider supporting other writers with a donation."]}),S?Object(je.jsx)("div",{className:"loader",children:Object(je.jsx)(xe.a,{type:"ThreeDots",color:"#ccd5ae",height:80,timeout:5e3})}):1===r.currentPage?(console.log("g1 render"),Object(je.jsx)("div",{className:"stories-grid author-stories-grid",children:k()})):(console.log("g2 render"),Object(je.jsx)("div",{className:"stories-grid stories-grid-2 author-stories-grid",children:t.map((function(e,t){return Object(je.jsx)("div",{className:"story-item-container",children:Object(je.jsx)(o.b,{to:"/story/".concat(e._id),onClick:function(){return w(e._id,null===p||void 0===p?void 0:p._id)},children:Object(je.jsxs)("div",{className:"story-item",children:[Object(je.jsx)("h3",{children:e.title}),Object(je.jsxs)("p",{className:"story-page-author",children:["Posted by: ",e.username]}),Object(je.jsx)("p",{className:"story-page-desc",children:e.description})]})})},t)}))})),S?null:Object(je.jsx)(Se,{pager:r,currentPage:v,path:"/stories/",clearStore:b})]})]})})),we=Object(c.b)((function(e){return{auth:e.auth,story:e.story,error:e.error}}),{postStory:function(e,t){var n=e.title,r=e.description,a=e.content,c=e.creator;return function(){var e=Object(h.a)(j.a.mark((function e(s){var i,o;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,m.a.post("/api/create-story",{title:n,description:r,content:a,creator:c});case 3:i=e.sent,s({type:x,payload:i.data.story}),s({type:q,payload:i.data.msg}),t.push("/"),e.next=14;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0),o={statusCode:e.t0.response.status,message:e.t0.response.data.error,statusText:e.t0.response.data.statusText},s({type:I,payload:o});case 14:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}()},clearError:ie,dropNav:ce})((function(e){var t=e.postStory,n=e.auth,r=e.history,a=e.error,c=e.clearError,s=e.dropNav,i=Object(d.useState)(!1),o=Object(l.a)(i,2),u=o[0],p=o[1],j=Object(ge.a)(),h=j.register,b=j.handleSubmit,m=j.errors;Object(d.useEffect)((function(){return function(){s(!1)}}),[s]);var f=function(e){var a=n._id,c=e.title,s=e.description,i=e.content;t({title:c,description:s,content:i,creator:a},r)},O=function(){if(u)return Object(je.jsxs)("div",{className:"how-to-format-container",children:[Object(je.jsxs)("p",{children:['Writer\'s Desk uses "marked" for formatting user stories. Most users only need to know that hitting the space button twice will format the text to a new line. ',Object(je.jsx)("br",{}),"  For everything else however, check out the ",Object(je.jsx)("span",{children:Object(je.jsx)("a",{href:"https://marked.js.org/",children:"marked demo"})})," for all formatting options"]}),Object(je.jsx)("button",{type:"button",className:"btn change-esc-btn",onClick:function(){return p(!1)},children:"X"})]})};return Object(je.jsx)("div",{children:a?fe(a,c):Object(je.jsxs)("div",{className:"add-story-container",children:[Object(je.jsx)("div",{className:"header-container",children:Object(je.jsx)("h1",{children:"Submit Your Story!"})}),Object(je.jsx)("div",{className:"forms-container",children:Object(je.jsxs)("form",{onSubmit:b(f),children:[Object(je.jsx)("div",{className:"form-btn-container",children:Object(je.jsx)("button",{type:"button",className:"btn htf-btn notification-btn",onClick:function(){return p(!0)},children:"How to format"})}),O(),Object(je.jsxs)("div",{className:"add-story-input-title add-story-item-container",children:[Object(je.jsx)("label",{children:" Add a Title"}),Object(je.jsx)("input",{name:"title",ref:h({required:!0,maxLength:100})}),m.title&&"required"===m.title.type&&Object(je.jsx)("p",{className:"validation-warning",children:"This is Required"}),m.title&&"maxLength"===m.title.type&&Object(je.jsx)("p",{className:"validation-warning",children:"Title should not be longer than 100 characters"})]}),Object(je.jsxs)("div",{className:"add-story-input-description add-story-item-container",children:[Object(je.jsx)("label",{children:" Short description"}),Object(je.jsx)("input",{name:"description",ref:h({required:!0,maxLength:200})}),m.description&&"required"===m.description.type&&Object(je.jsx)("p",{className:"validation-warning",children:"This is Required"}),m.description&&"maxLength"===m.description.type&&Object(je.jsx)("p",{className:"validation-warning",children:"Description should not be longer than 250 characters"})]}),Object(je.jsxs)("div",{className:"add-story-input-content add-story-item-container",children:[Object(je.jsx)("label",{children:"Story"}),Object(je.jsx)("textarea",{name:"content",ref:h({required:!0,minLength:100,maxLength:1e4})}),m.content&&"required"===m.content.type&&Object(je.jsx)("p",{className:"validation-warning",children:"This is Required"}),m.content&&"minLength"===m.content.type&&Object(je.jsx)("p",{className:"validation-warning",children:"A story must have at least 100 characters"}),m.content&&"maxLength"===m.content.type&&Object(je.jsx)("p",{className:"validation-warning",children:"The maximum length for a story is 10,000 characters"})]}),Object(je.jsx)("div",{className:"form-btn-container",children:Object(je.jsx)("button",{name:"submit-button",className:"green-btn btn",type:"submit",children:"Submit"})})]})})]})})})),ke=Object(c.b)((function(e){var t=e.author,n=e.auth,r=e.userStories;return{author:t,auth:n,pager:e.pager,userStories:r,error:e.error,message:e.message}}),{fetchAuthor:ee,updateUsername:function(e){return function(){var t=Object(h.a)(j.a.mark((function t(n){var r,a;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n({type:y,payload:"Updating..."}),t.prev=1,t.next=4,m.a.put("/account/update-username",{username:e});case 4:r=t.sent,n({type:v,payload:r.data.user}),t.next=12;break;case 8:t.prev=8,t.t0=t.catch(1),a={statusCode:t.t0.response.status,message:t.t0.response.data.error,statusText:t.t0.response.data.statusText},n({type:I,payload:a});case 12:case"end":return t.stop()}}),t,null,[[1,8]])})));return function(e){return t.apply(this,arguments)}}()},updateUserDesc:function(e){return function(){var t=Object(h.a)(j.a.mark((function t(n){var r,a;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n({type:g,payload:"Updating..."}),t.prev=1,t.next=4,m.a.put("/account/update-desc",{description:e});case 4:r=t.sent,n({type:v,payload:r.data.user}),t.next=12;break;case 8:t.prev=8,t.t0=t.catch(1),a={statusCode:t.t0.response.status,message:t.t0.response.data.error,statusText:t.t0.response.data.statusText},n({type:I,payload:a});case 12:case"end":return t.stop()}}),t,null,[[1,8]])})));return function(e){return t.apply(this,arguments)}}()},fetchUserStories:Q,clearError:ie,deleteUser:function(e,t){return function(){var n=Object(h.a)(j.a.mark((function n(r){var a,c;return j.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,m.a.delete("/account/"+e);case 3:a=n.sent,r({type:D,payload:a.data.msg}),t.push("/"),n.next=13;break;case 8:n.prev=8,n.t0=n.catch(0),console.log(n.t0),c={statusCode:n.t0.response.status,message:n.t0.response.data.error,statusText:n.t0.response.data.statusText},r({type:I,payload:c});case 13:case"end":return n.stop()}}),n,null,[[0,8]])})));return function(e){return n.apply(this,arguments)}}()},clearMessage:se,clearUserStories:de,dropNav:ce})((function(e){var t=e.userStories,n=e.auth,r=e.updateUsername,a=e.updateUserDesc,c=e.fetchUserStories,s=e.match,i=e.pager,u=e.clearError,p=e.error,j=e.deleteUser,h=e.history,b=e.clearMessage,m=e.message,f=e.clearUserStories,O=e.dropNav,x=Object(d.useState)(!0),v=Object(l.a)(x,2),y=v[0],g=v[1],N={username:n.username},S={description:n.description},E=Object(ge.a)({defaultValues:N}),w=E.register,k=E.handleSubmit,T=E.errors,C=Object(ge.a)({defaultValues:S}),_=C.register,P=C.errors,A=C.handleSubmit;Object(d.useEffect)((function(){return function(){O(!1)}}),[O]);var L=Object(d.useState)(!1),R=Object(l.a)(L,2),I=R[0],D=R[1],U=Object(d.useState)(!1),q=Object(l.a)(U,2),M=q[0],H=q[1],Y=Object(d.useState)(!1),B=Object(l.a)(Y,2),F=B[0],G=B[1],z=Object(d.useState)(!1),X=Object(l.a)(z,2),W=X[0],V=X[1],K=Object(d.useState)(s.params.page),J=Object(l.a)(K,2),Q=J[0],$=J[1];Object(d.useEffect)((function(){$(s.params.page)}),[$,s.params.page]),Object(d.useEffect)((function(){n||Z()}),[n]),Object(d.useEffect)((function(){n._id&&c(Q||1,n._id)}),[n,Q]),Object(d.useEffect)((function(){t.length<1&&g(!0),t.length>0&&g(!1)}),[t.length]),Object(d.useEffect)((function(){return function(){u()}}),[u]);var ee=function(e){r(e.username),D(!1)},te=function(e){a(e.description),H(!1)},ne=function(){if(n)return Object(je.jsxs)("div",{className:"author-data-container user-data-container",children:[Object(je.jsx)("div",{className:"header-container",children:Object(je.jsx)("h1",{children:"Your Profile"})}),n.donationsRecieved||n.donationsSent?Object(je.jsxs)("div",{className:"author-donations-container author-data-item",children:[n.donationsRecieved?Object(je.jsxs)("p",{children:["Donations received:  \xa3",n.donationsRecieved]}):null,n.donationsSent?Object(je.jsxs)("p",{children:["You have donated: \xa3",n.donationsSent," "]}):null]}):null,Object(je.jsxs)("div",{className:"author-username-container author-data-item",children:[Object(je.jsx)("p",{children:n?n.username?n.username:n.name:null}),Object(je.jsx)("button",{className:"btn green-btn",onClick:function(){D(!0),V(!0)},children:"Edit Username"})]}),re(),Object(je.jsxs)("div",{className:"author-description-container  author-data-item",children:[Object(je.jsx)("p",{children:n?n.description?n.description:"You don't have a description yet":null}),Object(je.jsx)("button",{className:"btn green-btn",onClick:function(){H(!0),V(!0)},children:n.description?"Edit Description":"Add Description"})]}),ae(),Object(je.jsxs)("div",{className:"author-delete-container\n                      author-data-item\n                      ".concat(F&&"hide"),children:[Object(je.jsx)("p",{children:"Delete your profile"}),Object(je.jsx)("button",{className:"btn danger-btn",onClick:function(){G(!0),V(!0)},children:"DELETE"})]}),ce()]})},re=function(){if(n)return Object(je.jsxs)("div",{className:"update-info-container author-data-item ".concat(I&&"active"),children:[Object(je.jsx)("button",{className:"change-esc-btn btn",onClick:function(){D(!1),V(!1)},children:"X"}),Object(je.jsxs)("form",{onSubmit:k(ee),children:[Object(je.jsx)("label",{children:"Change Username: "}),Object(je.jsxs)("div",{className:"input-container",children:[Object(je.jsx)("input",{name:"username",ref:w({required:!0,maxLength:30})}),Object(je.jsx)("div",{className:"submit-btn-container",children:Object(je.jsx)("button",{type:"submit",className:"btn green-btn",children:"Submit"})})]}),T.username&&"required"===T.username.type&&Object(je.jsx)("p",{className:"validation-warning",children:"Required"}),T.username&&"maxLength"===T.username.type&&Object(je.jsx)("p",{className:"validation-warning",children:"Username should not be longer than 30 characters"})]})]})},ae=function(){if(n)return Object(je.jsxs)("div",{className:"update-info-container author-data-item ".concat(M&&"active"),children:[Object(je.jsx)("button",{className:"change-esc-btn btn",onClick:function(){H(!1),V(!1)},children:"X"}),Object(je.jsxs)("form",{onSubmit:A(te),children:[Object(je.jsx)("label",{children:n.description?"Edit your description":"Add a description to your profile"}),Object(je.jsxs)("div",{className:"input-container",children:[Object(je.jsx)("input",{name:"description",ref:_({required:!0,minLength:5,maxLength:100})}),Object(je.jsx)("div",{className:"submit-btn-container",children:Object(je.jsx)("button",{type:"submit",className:"btn green-btn",children:"Submit"})})]}),P.description&&"required"===P.description.type&&Object(je.jsx)("p",{className:"validation-warning",children:"Required"}),P.description&&"maxLength"===P.description.type&&Object(je.jsx)("p",{className:"validation-warning",children:"Description should not be longer than 100 characters"}),P.description&&"minLength"===P.description.type&&Object(je.jsx)("p",{className:"validation-warning",children:"Descriptions must have at least 5 characters"})]})]})},ce=function(){return Object(je.jsxs)("div",{className:"update-info-container author-data-item ".concat(F&&"active"),children:[Object(je.jsx)("button",{className:"change-esc-btn btn",onClick:function(){G(!1),V(!1)},children:"X"}),Object(je.jsx)("p",{className:"author-delete-text",children:"Are you sure you want to delete your profile? All your data will be removed permenantly "}),Object(je.jsx)("div",{className:"submit-btn-container",children:Object(je.jsx)("button",{className:"btn danger-btn",onClick:function(){j(n._id,h)},children:"Yes, Delete My Profile"})})]})};return Object(je.jsxs)("div",{children:[function(){if(m)return Object(je.jsxs)("div",{className:"message-container",children:[Object(je.jsx)("p",{children:m}),Object(je.jsx)("button",{onClick:function(){return b()},children:"Close"})]})}(),p?fe(p,u):Object(je.jsxs)("div",{className:"author-page-container",children:[Object(je.jsx)("div",{className:"change-details-bg-container ".concat(W&&"active"," ")}),ne(),Object(je.jsx)("div",{className:"header-container sub-header-container",children:Object(je.jsx)("h2",{children:Q&&1!==Q?"Your Stories - Page ".concat(Q):"Your Stories"})}),y?Object(je.jsx)("div",{className:"loader loader-author",children:Object(je.jsx)(xe.a,{type:"ThreeDots",color:"#ccd5ae",height:80,timeout:5e3})}):Object(je.jsx)("div",{className:"stories-grid author-stories-grid",children:t?t.map((function(e){return Object(je.jsx)("div",{className:"story-item-container",children:Object(je.jsx)(o.b,{to:"/story/".concat(e._id),children:Object(je.jsxs)("div",{className:"story-item",children:[Object(je.jsx)("h3",{children:e.title}),Object(je.jsxs)("p",{className:"story-page-author",children:["Posted by: ",e.username]}),Object(je.jsx)("p",{className:"story-page-desc",children:e.description})]})})},e._id)})):null}),y?null:Object(je.jsx)(Se,{pager:i,currentPage:Q,path:"/your-profile/",clearStore:f})]})]})})),Te=Object(c.b)((function(e){return{story:e.story,auth:e.auth,error:e.error}}),{updateStoryComments:function(e,t){return function(){var n=Object(h.a)(j.a.mark((function n(r){var a,c;return j.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,m.a.post("/api/stories/comments/".concat(e),{commentText:t});case 3:a=n.sent,r({type:k,payload:a.data.comment}),n.next=11;break;case 7:n.prev=7,n.t0=n.catch(0),c={statusCode:n.t0.response.status,message:n.t0.response.data.error,statusText:n.t0.response.data.statusText},r({type:I,payload:c});case 11:case"end":return n.stop()}}),n,null,[[0,7]])})));return function(e){return n.apply(this,arguments)}}()},deleteStoryComment:function(e,t){return function(){var n=Object(h.a)(j.a.mark((function n(r){var a;return j.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,m.a.delete("/api/stories/comments/".concat(e,"/").concat(t));case 3:r({type:M,payload:t}),n.next=11;break;case 6:n.prev=6,n.t0=n.catch(0),console.log(n.t0),a={statusCode:n.t0.response.status,message:n.t0.response.data.error,statusText:n.t0.response.data.statusText},r({type:I,payload:a});case 11:case"end":return n.stop()}}),n,null,[[0,6]])})));return function(e){return n.apply(this,arguments)}}()},fetchStory:$,clearError:ie,clearAuthor:ue})((function(e){var t=e.story,n=e.updateStoryComments,r=e.auth,a=e.deleteStoryComment,c=e.clearAuthor,s=Object(ge.a)(),i=s.register,u=s.handleSubmit,p=s.errors,b=s.reset,m=Object(d.useState)(1),f=Object(l.a)(m,2),O=f[0],x=f[1],v=Object(d.useState)(null),y=Object(l.a)(v,2),g=y[0],N=y[1],S=function(){var e=Object(h.a)(j.a.mark((function e(r){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n(t._id,r.commentText),b();case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();Object(d.useEffect)((function(){return function(){if(t.comments&&!g){t.comments.reverse();var e=5*(O-1),n=t.comments.slice(e,e+5);N(n)}else if(t.comments){var r=5*(O-1),a=t.comments.slice(r,r+5);N(a)}}(),function(){N(null)}}),[O,t]);return Object(je.jsxs)("div",{className:"comments-container",children:[Object(je.jsx)("div",{className:"sub-header-container",children:Object(je.jsx)("h2",{children:"Comments"})}),Object(je.jsxs)("form",{onSubmit:u(S),children:[Object(je.jsx)("label",{children:"Add a Comment"}),Object(je.jsxs)("div",{className:"input-container",children:[Object(je.jsx)("input",{name:"commentText",ref:i({required:!0,maxLength:100})}),Object(je.jsx)("button",{type:"submit",className:"btn green-btn",children:"Post"})]}),p.commentText&&"maxLength"===p.commentText.type&&Object(je.jsx)("p",{className:"validation-warning",children:"Comments have a max length of 100 characters"})]}),Object(je.jsx)("ul",{className:"comments-list",children:g?g.length>0?g.map((function(e){return Object(je.jsxs)("li",{className:"comment-container",children:[Object(je.jsxs)("div",{className:"comment-left",children:[Object(je.jsx)("p",{className:"comment-text",children:e.commentText}),Object(je.jsx)("p",{className:"comment-user",children:Object(je.jsx)(o.b,{to:"/author/".concat(e.userId),onClick:function(){return c()},children:e.username})})]}),Object(je.jsx)("div",{className:"comment-right",children:e.userId===r._id?Object(je.jsx)("button",{onClick:function(){return n=t._id,r=e.id,void a(n,r);var n,r},className:"btn delete-btn",children:"Delete"}):null})]},e.id)})):g&&0!==g.length?void 0:Object(je.jsx)("div",{className:"no-comments-container",children:Object(je.jsx)("p",{children:"No comments yet!"})}):Object(je.jsx)("div",{className:"no-comments-container",children:Object(je.jsx)("p",{children:"No comments yet!"})})}),function(){if(t.comments){var e=t.comments.length,n=Math.ceil(t.comments.length/5),r=O,a=5*O<e,c=O+1,s=O>1,i=O-1,o=n;return Object(je.jsx)("div",{className:"paginate-container pg-comments",children:Object(je.jsxs)("ul",{children:[1!==r&&1!==i?Object(je.jsx)("li",{className:"comment-li",children:Object(je.jsx)("button",{onClick:function(){return x(1)},children:"1"})}):null,s?Object(je.jsx)("li",{className:"comment-li",children:Object(je.jsx)("button",{onClick:function(){return x(i)},children:i})}):null,Object(je.jsx)("li",{className:"comment-li",children:Object(je.jsx)("button",{onClick:function(){return x(r)},children:r})}),a?Object(je.jsx)("li",{className:"comment-li",children:Object(je.jsx)("button",{onClick:function(){return x(c)},children:c})}):null,o!==r&&c!==o&&0!==o?Object(je.jsx)("li",{className:"comment-li",children:Object(je.jsx)("button",{onClick:function(){return x(o)},children:o})}):null]})})}}()]})})),Ce=Object(c.b)((function(e){return{story:e.story,author:e.author,auth:e.auth,error:e.error,message:e.message}}),{fetchStory:$,fetchAuthor:ee,deleteStory:function(e){return function(){var t=Object(h.a)(j.a.mark((function t(n){var r;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,m.a.delete("/api/stories/".concat(e));case 3:n({type:"DELETE_STORY",payload:e}),n({type:q,payload:"Story Deleted"}),t.next=12;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0),r={statusCode:t.t0.response.status,message:t.t0.response.data.error,statusText:t.t0.response.data.statusText},n({type:I,payload:r});case 12:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()},clearError:ie,clearMessage:se,dropNav:ce})((function(e){var t=e.match,n=e.story,r=e.fetchStory,a=e.fetchAuthor,c=e.author,s=e.deleteStory,i=e.auth,u=e.history,p=e.clearError,b=e.error,m=e.message,f=e.clearMessage,O=e.dropNav,x=Object(d.useState)(!1),v=Object(l.a)(x,2),y=v[0],g=v[1],N=Object(d.useState)(!0),S=Object(l.a)(N,2),E=S[0],w=S[1];Object(d.useEffect)((function(){n||r(t.params.storyId)}),[n,r,t.params.storyId]),Object(d.useEffect)((function(){n&&!c&&n._user&&a(n._user)}),[n,a,c]),Object(d.useEffect)((function(){n&&c&&w(!1)})),Object(d.useEffect)((function(){return function(){p()}}),[p]),Object(d.useEffect)((function(){return function(){f()}}),[f]),Object(d.useEffect)((function(){return function(){O(!1)}}),[O]);var k=function(e){return e.username?e.username:e.name},T=function(){var e=Object(h.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s(t);case 2:u.push("/your-profile");case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),C=function(){if(y)return Object(je.jsx)("div",{className:"message-container",children:Object(je.jsxs)("div",{className:"message warning-message",children:[Object(je.jsx)("p",{children:"Are you sure you want to delete your story?"}),Object(je.jsx)("button",{className:"btn danger-btn",onClick:function(){return T(n._id)},children:"delete"}),Object(je.jsx)("button",{className:"btn change-esc-btn \r cancel-delete-story-btn",onClick:function(){return g(!1)},children:"X"})]})})},_=function(){if(n&&i)return n._user===i._id?Object(je.jsxs)("div",{className:"story-edit-btns",children:[Object(je.jsxs)("div",{className:"story-btns-container",children:[Object(je.jsx)(o.b,{className:"btn green-btn",to:"/edit-story/".concat(n._id),children:"edit"}),Object(je.jsx)("button",{className:"btn delete-btn",onClick:function(){return g(!0)},children:"delete"})]}),C()]}):Object(je.jsxs)("div",{className:"story-donate-btns-container",children:[Object(je.jsx)("p",{children:"Like the story?"}),Object(je.jsx)(o.b,{to:"/payment/".concat(c._id),className:"btn green-btn",children:"Donate"})]})};return Object(je.jsxs)("div",{children:[function(){if(m)return Object(je.jsx)("div",{className:"message-container",children:Object(je.jsxs)("div",{className:"message",children:[Object(je.jsx)("p",{children:m}),Object(je.jsx)("button",{className:"btn notification-btn",onClick:function(){return f()},children:"Close"})]})})}(),b?fe(b,p):E?Object(je.jsx)("div",{className:"loader loader-margin",children:Object(je.jsx)(xe.a,{type:"ThreeDots",color:"#ccd5ae",height:80,timeout:5e3})}):Object(je.jsx)("div",{children:c&&n?Object(je.jsxs)("div",{className:"story-page-container",children:[Object(je.jsx)("div",{className:"header-container",children:Object(je.jsx)("h1",{children:n.title})}),_(),Object(je.jsx)("p",{children:n.creator}),Object(je.jsx)("p",{className:"story-page-desc",children:n.description}),Object(je.jsx)("div",{className:"author-container",children:Object(je.jsxs)("p",{children:["Written By:",Object(je.jsx)(o.b,{to:"/author/".concat(n._user),children:Object(je.jsxs)("span",{children:[" ",k(c)]})})]})}),Object(je.jsxs)("div",{className:"story-page-grid",children:[Object(je.jsx)("div",{className:"story-page-main-item grid-item",children:Object(je.jsx)("p",{dangerouslySetInnerHTML:{__html:"".concat(n.sanitizedHtml)},className:"story-page-story"})}),Object(je.jsx)("div",{className:"story-page-sub-item grid-item",children:Object(je.jsx)(Te,{})})]})]}):null})]})})),_e=Object(c.b)((function(e){return{author:e.author,auth:e.auth,userStories:e.userStories,pager:e.pager,error:e.error}}),{fetchAuthorBasic:te,fetchUserStories:Q,clearError:ie,clearUserStories:de,dropNav:ce,clearPagination:pe})((function(e){var t=e.author,n=e.match,r=e.fetchUserStories,a=e.userStories,c=e.fetchAuthorBasic,s=e.pager,i=e.error,u=e.clearError,p=e.clearUserStories,j=e.dropNav,h=e.clearPagination,b=Object(d.useState)(n.params.page),m=Object(l.a)(b,2),f=m[0],O=m[1],x=Object(d.useState)(!0),v=Object(l.a)(x,2),y=v[0],g=v[1];Object(d.useEffect)((function(){O(n.params.page||1)}),[O,n.params.page,f]),Object(d.useEffect)((function(){t||c(n.params.authorId)}),[c,n.params.authorId,t]),Object(d.useEffect)((function(){a.length<1&&r(f||1,n.params.authorId)}),[f,n.params.authorId]),Object(d.useEffect)((function(){t&&g(!1)}),[y,t]),Object(d.useEffect)((function(){return function(){p(),h()}}),[]),Object(d.useEffect)((function(){return function(){j(!1)}}),[j]);var N=function(){return t?t.username?t.username:t.name:null};return Object(je.jsx)("div",{children:i?fe(i,u):y?Object(je.jsx)("div",{className:"loader loader-margin",children:Object(je.jsx)(xe.a,{type:"ThreeDots",color:"#ccd5ae",height:80,timeout:5e3})}):Object(je.jsxs)("div",{className:"author-page-container",children:[t?Object(je.jsxs)("div",{className:"author-data-container",children:[Object(je.jsx)("div",{className:"header-container",children:Object(je.jsx)("h1",{children:N()})}),Object(je.jsx)("p",{children:t&&t.description?t.description:null}),Object(je.jsx)(o.b,{to:"/payment/".concat(t._id),className:"btn green-btn",children:"Donate"}),Object(je.jsxs)("div",{className:"author-donations-container",children:[t.donationsRecieved?Object(je.jsxs)("p",{children:[N()," has received :  \xa3",t.donationsRecieved," from other users!"]}):null,t.donationsSent?Object(je.jsxs)("p",{children:[N()," has dontated  \xa3",t.donationsSent," to other authors!"]}):null]})]}):null,Object(je.jsx)("div",{className:"header-container sub-header-container",children:Object(je.jsx)("h2",{children:f&&1!==f?"".concat(N(),"'s Stories - Page ").concat(f):"".concat(N(),"'s Stories ")})}),Object(je.jsx)("div",{className:"stories-grid author-stories-grid",children:t&&a?a.map((function(e){return Object(je.jsx)("div",{className:"story-item-container author-story-container",children:Object(je.jsx)(o.b,{to:"/story/".concat(e._id),children:Object(je.jsxs)("div",{className:"story-item",children:[Object(je.jsx)("h3",{children:e.title}),Object(je.jsxs)("p",{className:"story-page-author",children:["Posted by: ",e.username]}),Object(je.jsx)("p",{className:"story-page-desc",children:e.description})]})})},e._id)})):null}),y?null:Object(je.jsx)(Se,{pager:s,currentPage:f,path:"/author/".concat(n.params.authorId,"/"),clearStore:p})]})})})),Pe=Object(c.b)((function(e){return{auth:e.auth,story:e.story,error:e.error}}),{editStory:function(e,t){var n=e.storyId,r=e.title,a=e.description,c=e.content;return function(){var e=Object(h.a)(j.a.mark((function e(s){var i,o;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,m.a.put("/api/stories/"+n,{title:r,description:a,content:c});case 3:i=e.sent,s({type:A,payload:i.data.story}),s({type:q,payload:i.data.msg}),t.push("/story/"+n),e.next=14;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0),o={statusCode:e.t0.response.status,message:e.t0.response.data.error,statusText:e.t0.response.data.statusText},s({type:I,payload:o});case 14:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}()},clearError:ie,dropNav:ce})((function(e){var t=e.story,n=e.editStory,r=e.history,a=e.match,c=e.error,s=e.dropNav;Object(d.useEffect)((function(){t||$(a.params.storyId)}),[t,a.params.storyId]),Object(d.useEffect)((function(){return function(){s(!1)}}),[s]);var i={title:t.title,description:t.description,content:t.content},o=Object(ge.a)({defaultValues:i}),u=o.register,l=o.handleSubmit,p=o.errors,j=function(e){var t=a.params.storyId,c=e.title,s=e.description,i=e.content;n({title:c,description:s,content:i,storyId:t},r)};return Object(je.jsx)("div",{children:c?fe(c,ie):Object(je.jsx)("div",{className:"add-story-container",children:Object(je.jsx)("div",{className:"forms-container",children:Object(je.jsxs)("form",{onSubmit:l(j),children:[Object(je.jsx)("div",{className:"header-container",children:Object(je.jsx)("h1",{children:"Edit Your Story!"})}),Object(je.jsxs)("div",{className:"add-story-input-title add-story-item-container",children:[Object(je.jsx)("label",{children:" Edit Title"}),Object(je.jsx)("input",{name:"title",ref:u({required:!0,maxLength:100})}),p.title&&"required"===p.title.type&&Object(je.jsx)("p",{children:"This is required"}),p.title&&"maxLength"===p.title.type&&Object(je.jsx)("p",{children:"Title should not be longer than 100 characters"})]}),Object(je.jsxs)("div",{className:"add-story-input-description add-story-item-container",children:[Object(je.jsx)("label",{children:" Edit description"}),Object(je.jsx)("input",{name:"description",ref:u({required:!0,maxLength:200})}),p.description&&"required"===p.description.type&&Object(je.jsx)("p",{children:"Required"}),p.description&&"maxLength"===p.description.type&&Object(je.jsx)("p",{children:"Description should not be longer than 250 characters"})]}),Object(je.jsxs)("div",{className:"add-story-input-content add-story-item-container",children:[Object(je.jsx)("label",{children:"Edit Story"}),Object(je.jsx)("textarea",{name:"content",ref:u({required:!0,minLength:100,maxLength:1e4})}),p.content&&"required"===p.content.type&&Object(je.jsx)("p",{children:"Required"}),p.content&&"minLength"===p.content.type&&Object(je.jsx)("p",{children:"A story must have at least 100 characters"}),p.content&&"maxLength"===p.content.type&&Object(je.jsx)("p",{children:"The maximum length for a story is 10,000 characters"})]}),Object(je.jsx)("button",{className:"add-username-btn btn",type:"submit",children:"Submit"})]})})})})})),Ae=Object(c.b)((function(e){return{snippets:e.snippets,auth:e.auth,pager:e.pager,error:e.error}}),{postSnippet:ne,fetchAllSnippets:function(e){return function(){var t=Object(h.a)(j.a.mark((function t(n){var r;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,m.a.get("/api/all-snippets/?page="+e);case 2:r=t.sent,n({type:C,payload:r.data.snippets}),n({type:_,payload:r.data.pager});case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},addSnippet:ae,deleteSnippet:re,displayError:fe,clearError:ie,clearSnippets:le,dropNav:ce,clearPagination:pe})((function(e){var t=e.postSnippet,n=e.fetchAllSnippets,r=e.snippets,a=e.addSnippet,c=e.auth,s=e.deleteSnippet,i=e.pager,u=e.match,p=e.error,j=e.clearError,h=e.clearSnippets,b=e.history,m=e.dropNav,f=e.clearPagination,O=Object(ge.a)(),x=O.register,v=O.handleSubmit,y=O.errors,g=O.reset,N=Object(d.useState)(u.params.page),S=Object(l.a)(N,2),E=S[0],w=S[1],k=Object(d.useState)(!0),T=Object(l.a)(k,2),C=T[0],_=T[1];Object(d.useEffect)((function(){w(u.params.page||1)}),[w,u.params.page,E]),Object(d.useEffect)((function(){var e=ye()("https://writers-desk.herokuapp.com");return e.on("snippets",(function(e){"create"===e.action&&a(e.snippet),"delete"===e.action&&n()})),function(){e.off("snippets")}}),[]),Object(d.useEffect)((function(){r.length<1?n(E||1):n(1)}),[E]),Object(d.useEffect)((function(){r.length>0&&_(!1),r.length<1&&_(!0)}),[r]),Object(d.useEffect)((function(){return function(){m(!1)}}),[m]),Object(d.useEffect)((function(){return function(){f()}}),[]);var P=function(e){t(e.snippetText),g(),h(),b.push("/snippets/1")};return Object(je.jsx)("div",{children:p?fe(p,j):Object(je.jsxs)("div",{className:"all-snippets-container snippets-container",children:[Object(je.jsx)("div",{className:"header-container snippets-header",children:Object(je.jsx)("h1",{children:"All Snippets"})}),Object(je.jsx)("p",{className:"snippets-sub-header",children:"Let other writers know what you're up to, add a short snippet to the live feed."}),Object(je.jsxs)("form",{className:"snippet-form",onSubmit:v(P),children:[Object(je.jsx)("label",{children:"Post a snippet"}),Object(je.jsxs)("div",{className:"input-container",children:[Object(je.jsx)("input",{name:"snippetText",ref:x({required:!0,maxLength:100}),className:"snippets-home-input"}),Object(je.jsx)("div",{className:"snippet-btn-container",children:Object(je.jsx)("button",{className:"btn green-btn",type:"submit",children:"Post"})})]}),y.snippetText&&"maxLength"===y.snippetText.type&&Object(je.jsx)("p",{className:"validation-warning",children:"Snippets have a max length of 100 characters"})]}),C?Object(je.jsx)("div",{className:"loader loader-margin",children:Object(je.jsx)(xe.a,{type:"ThreeDots",color:"#ccd5ae",height:80,timeout:1e5})}):Object(je.jsx)("div",{className:"snippets-list",children:(r.length>10?r.slice(0,10):r).map((function(e){return Object(je.jsxs)("div",{className:"snippet-container",children:[Object(je.jsxs)("div",{className:"snippet-left",children:[Object(je.jsx)("p",{className:"snippet-text",children:e.text}),Object(je.jsx)("p",{className:"snippet-username",children:Object(je.jsx)(o.b,{to:"/author/".concat(e._user),children:e.username})})]}),Object(je.jsx)("div",{className:"snippet-right",children:e._user===(null===c||void 0===c?void 0:c._id)?Object(je.jsx)("button",{className:"btn delete-btn",onClick:function(){return s(e._id)},children:"Delete"}):null})]},e._id)}))}),C?null:Object(je.jsx)(Se,{pager:i,currentPage:E,path:"/snippets/",clearStore:h})]})})})),Le=n(73),Re=Object(Le.a)("pk_test_51HopnLK7csUlSCmRxKe3WpdUYwBenxozM3UsaiprA9Zz1RtER9LQjM0HkINbs6r5XmaOmD7jsPolMqGzOC7Lgxbx00y8ePgpuu"),Ie=function(e){var t=e.handleClick,n=e.amount,r=e.setAmount;return Object(je.jsxs)("div",{className:"payment-before",children:[Object(je.jsx)("div",{className:"header-container",children:Object(je.jsx)("h1",{children:"Support the author with a donation!"})}),Object(je.jsx)("label",{children:"Select an Amount"}),Object(je.jsxs)("select",{value:n,onChange:function(e){return r(e.target.value)},children:[Object(je.jsx)("option",{value:"1",children:"\xa31"}),Object(je.jsx)("option",{value:"2",children:"\xa32"}),Object(je.jsx)("option",{value:"3",children:"\xa33"}),Object(je.jsx)("option",{value:"4",children:"\xa34"}),Object(je.jsx)("option",{value:"5",children:"\xa35"})]}),Object(je.jsx)("button",{type:"button",id:"checkout-button",role:"link",onClick:t,className:"btn green-btn",children:"Checkout"})]})},De=function(e){var t=e.message;return Object(je.jsxs)("section",{className:"payment-after",children:[Object(je.jsx)("p",{children:t}),Object(je.jsx)(o.b,{to:"/",children:"Back to HomePage"})]})},Ue=Object(c.b)((function(e){return{author:e.author,auth:e.auth}}),{fetchAuthorBasic:te,postPayment:function(e,t,n,r){return function(){var a=Object(h.a)(j.a.mark((function a(c){var s,i;return j.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,m.a.post("/post-payment-data",{amount:e,authorId:t,userId:n,paymentId:r});case 3:s=a.sent,c({type:H,payload:s.data.user}),a.next=11;break;case 7:a.prev=7,a.t0=a.catch(0),i={statusCode:a.t0.response.status,message:a.t0.response.data.error,statusText:a.t0.response.data.statusText},c({type:I,payload:i});case 11:case"end":return a.stop()}}),a,null,[[0,7]])})));return function(e){return a.apply(this,arguments)}}()},clearError:ie,dropNav:ce})((function(e){var t=e.author,n=e.match,r=e.fetchAuthorBasic,a=e.auth,c=e.postPayment,s=e.clearError,i=e.dropNav,o=Object(d.useState)(1),u=Object(l.a)(o,2),p=u[0],b=u[1],f=Object(d.useState)(""),O=Object(l.a)(f,2),x=O[0],v=O[1];Object(d.useEffect)((function(){return function(){s()}}),[]),Object(d.useEffect)((function(){return function(){i(!1)}}),[i]),Object(d.useEffect)((function(){var e=t?t.username?t.username:t.name:"",s=new URLSearchParams(window.location.search),i=s.get("amount")/100,o=s.get("paymentId");if(s.get("success")&&(v(t?"Your donation of \xa3".concat(i," to ").concat(e," was successful \ud83d\ude42"):"LOADING"),t&&a)){var u=t._id,l=a._id;c(i,u,l,o)}if(s.get("canceled")&&v("Payment Canceled."),!t&&!s.get("canceled"))if(n.params.authorId)r(n.params.authorId);else{var d=s.get("authorId");r(d)}}),[t]);var y=function(){var e=Object(h.a)(j.a.mark((function e(n){var r,a,c,s;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Re;case 2:return r=e.sent,a=t._id,e.next=6,m.a.post("/create-checkout-session",{amount:p,authorId:a});case 6:return c=e.sent,e.next=9,c.data;case 9:return s=e.sent,e.next=12,r.redirectToCheckout({sessionId:s.id});case 12:e.sent.error;case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return x?Object(je.jsx)(De,{message:x}):Object(je.jsx)(Ie,{handleClick:y,setAmount:b,amount:p})})),qe=function(){return Object(je.jsx)("footer",{children:Object(je.jsx)("div",{className:"footer-container",children:Object(je.jsx)("a",{href:"https://github.com/64-bit-david",children:"Created By David Williamson"})})})},Me=function(){return Object(je.jsx)("div",{class:"body-container",children:Object(je.jsxs)(o.a,{children:[Object(je.jsx)(be,{}),Object(je.jsx)(he,{}),Object(je.jsxs)("main",{class:"main",children:[Object(je.jsx)(u.a,{path:"/",exact:!0,component:Ee}),Object(je.jsx)(u.a,{path:"/stories/:page",component:Ee}),Object(je.jsx)(u.a,{path:"/add-story",component:we}),Object(je.jsx)(u.a,{path:"/edit-story/:storyId",component:Pe}),Object(je.jsx)(u.a,{path:"/story/:storyId",component:Ce}),Object(je.jsx)(u.a,{path:"/author/:authorId",exact:!0,component:_e}),Object(je.jsx)(u.a,{path:"/author/:authorId/:page",component:_e}),Object(je.jsx)(u.a,{path:"/your-profile/:page",exact:!0,component:ke}),Object(je.jsx)(u.a,{path:"/your-profile",exact:!0,component:ke}),Object(je.jsx)(u.a,{path:"/snippets/:page",exact:!0,component:Ae}),Object(je.jsx)(u.a,{path:"/payment/",exact:!0,component:Ue}),Object(je.jsx)(u.a,{path:"/payment/:authorId",component:Ue})]}),Object(je.jsx)(qe,{})]})})};var He=n(13),Ye=n(26);var Be=function(e,t){var n=[t.payload].concat(Object(me.a)(e));return n.pop(),n};var Fe=function(e,t){var n=Object(Ye.a)({},e);return n.comments?n.comments.unshift(t.payload):n.comments=[t.payload],n},Ge=function(e,t){var n=Object(Ye.a)({},e);return n.comments=n.comments.filter((function(e){return e.id!==t.payload})),n};var ze=Object(s.c)({stories:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case f:return t.payload;case x:return Be(e,t);case G:return[];default:return e}},auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case O:return t.payload||!1;case v:return t.payload;case y:return Object(Ye.a)(Object(Ye.a)({},e),{},Object(He.a)({},"username",t.payload));case g:return Object(Ye.a)(Object(Ye.a)({},e),{},Object(He.a)({},"description",t.payload));case H:return t.payload;case D:return console.log("deletion reached auth reducer"),null;default:return e}},story:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case S:case N:case A:return t.payload;case k:return Fe(e,t);case M:return Ge(e,t);case L:return{};case W:return null;default:return e}},author:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case E:case w:return t.payload;case L:case X:return null;default:return e}},snippets:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case C:return t.payload;case T:return[t.payload].concat(Object(me.a)(e));case P:return e.filter((function(e){return e._id!==t.payload}));case V:return[];default:return e}},pager:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case _:return t.payload;case J:return{};default:return e}},userStories:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case R:return t.payload;case L:case G:case K:return[];default:return e}},error:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case I:return t.payload;case z:return null;default:return e}},message:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case D:case q:return t.payload;case U:return null;default:return e}},loading:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case F:return t.payload;case L:return null;default:return e}},navStatus:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Y:return!0;case B:return!1;default:return e}}}),Xe=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||s.d,We=Object(s.e)(ze,Xe(Object(s.a)(i.a)));a.a.render(Object(je.jsx)(c.a,{store:We,children:Object(je.jsx)(Me,{})}),document.getElementById("root"))},74:function(e,t,n){}},[[150,1,2]]]);
//# sourceMappingURL=main.f6139998.chunk.js.map
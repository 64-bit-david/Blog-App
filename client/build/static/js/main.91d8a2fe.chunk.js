(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{150:function(e,t,n){"use strict";n.r(t);n(74);var r=n(35),a=n.n(r),c=n(9),s=n(25),i=n(72),o=n(3),u=n(11),l=n(1),d=n(2),p=n.n(d),j=n(4),h=n(10),b=n.n(h),m="FETCH_STORIES",f="FETCH_USER",O="POST_STORY",x="UPDATE_USER",v="UPDATING_USERNAME",g="UPDATING_DESCRIPTION",y="FETCH_STORY",N="FETCH_STORY_REQUEST",S="FETCH_AUTHOR",E="FETCH_AUTHOR_BASIC",w="UPDATE_STORY_COMMENTS",k="POST_SNIPPET",T="FETCH_SNIPPETS",C="PAGINATE",_="DELETE_SNIPPET",P="EDIT_STORY",A="CLEAN_UP",I="FETCH_USER_STORIES",L="ADD_ERROR",R="DELETE_USER",D="CLEAR_MESSAGE",U="ADD_MESSAGE",q="DELETE_COMMENT",M="PAYMENT_SUCCESS",H="DROP_NAV",Y="UNDROP_NAV",B="LOADING",F="CLEAR_STORIES",G="CLEAR_ERROR",z="CLEAR_AUTHOR",W="CLEAR_STORY",X="CLEAR_SNIPPETS",V="CLEAR_USER_STORIES",J="CLEAR_PAGINATION",K=function(e,t){return function(){var n=Object(j.a)(p.a.mark((function n(r){var a;return p.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,b.a.get("/api/account/stories/".concat(t,"/?page=").concat(e));case 2:a=n.sent,r({type:I,payload:a.data.stories}),r({type:C,payload:a.data.pager});case 5:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},Q=function(){return function(){var e=Object(j.a)(p.a.mark((function e(t){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.a.get("/api/current_user");case 3:n=e.sent,t({type:f,payload:n.data}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()},Z=function(e){return function(){var t=Object(j.a)(p.a.mark((function t(n){var r,a;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,b.a.get("/api/stories/".concat(e));case 3:(r=t.sent).data.story.comments>0&&(r.data.story.comments=r.data.story.comments.reverse()),n({type:y,payload:r.data.story}),t.next=13;break;case 8:t.prev=8,t.t0=t.catch(0),a={statusCode:t.t0.response.status,message:t.t0.response.data.error,statusText:t.t0.response.data.statusText},console.log(a),n({type:L,payload:a});case 13:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e){return t.apply(this,arguments)}}()},$=function(e){return function(){var t=Object(j.a)(p.a.mark((function t(n){var r;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,b.a.get("/account/".concat(e));case 2:r=t.sent,n({type:S,payload:r.data});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},ee=function(e){return function(){var t=Object(j.a)(p.a.mark((function t(n){var r,a;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,b.a.get("/account/basic/".concat(e));case 3:r=t.sent,n({type:E,payload:r.data}),t.next=11;break;case 7:t.prev=7,t.t0=t.catch(0),a={statusCode:t.t0.response.status,message:t.t0.response.data.error,statusText:t.t0.response.data.statusText},n({type:L,payload:a});case 11:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()},te=function(e){return function(){var t=Object(j.a)(p.a.mark((function t(n){var r;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,b.a.post("/api/post-snippet",{snippetText:e});case 3:t.next=9;break;case 5:t.prev=5,t.t0=t.catch(0),r={statusCode:t.t0.response.status,message:t.t0.response.data.error,statusText:t.t0.response.data.statusText},n({type:L,payload:r});case 9:case"end":return t.stop()}}),t,null,[[0,5]])})));return function(e){return t.apply(this,arguments)}}()},ne=function(e){return function(){var t=Object(j.a)(p.a.mark((function t(n){return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,b.a.delete("/api/snippet/"+e);case 2:n({type:_,payload:e});case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},re=function(e){return{type:k,payload:e}},ae=function(e){return e?{type:H}:e?void 0:{type:Y}},ce=function(){return{type:D}},se=function(){return{type:G}},ie=function(){return{type:F}},oe=function(){return{type:z}},ue=function(){return{type:X}},le=function(){return{type:V}},de=function(){return{type:J}},pe=n(0),je=Object(c.b)((function(e){return{auth:e.auth,navStatus:e.navStatus}}),{fetchUser:Q,logout:function(){return function(){var e=Object(j.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.get("/api/logout");case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},dropNav:ae,clearStories:ie})((function(e){var t=e.fetchUser,n=e.auth,r=e.logout,a=e.navStatus,c=e.dropNav,s=e.clearStories;Object(l.useEffect)((function(){t()}),[t]);return Object(pe.jsx)("header",{children:Object(pe.jsxs)("div",{className:"header",children:[Object(pe.jsx)("div",{className:"header-left logo",children:Object(pe.jsx)(o.b,{to:"/",onClick:function(){return s()},children:Object(pe.jsx)("h2",{children:"Writer's Desk"})})}),Object(pe.jsx)("nav",{className:"header-right",children:n?(null===n||void 0===n?void 0:n._id)?Object(pe.jsxs)("div",{children:[Object(pe.jsxs)("div",{className:"header-right-menu ".concat(a&&"active"),children:[Object(pe.jsx)(o.b,{to:"/add-story",className:" btn dd-btn",onClick:function(){return c(!1)},children:"Add a Story"}),Object(pe.jsx)(o.b,{to:"/your-profile",className:" btn dd-btn",onClick:function(){return c(!1)},children:"Your Profile"}),Object(pe.jsx)("a",{href:"/api/logout",className:"btn dd-btn",onClick:function(){c(!1),r()},children:"Log Out"})]}),Object(pe.jsx)("div",{className:"burger ".concat(a&&"active"),children:Object(pe.jsxs)("button",{onClick:function(){return c(!a)},className:"burger-btn",title:"nav-drop",children:[Object(pe.jsx)("div",{className:"burger-line"}),Object(pe.jsx)("div",{className:"burger-line"}),Object(pe.jsx)("div",{className:"burger-line"})]})})]}):null:Object(pe.jsx)("div",{className:"google-btn ".concat(c&&"active"),children:Object(pe.jsx)("a",{className:"google-btn-link",href:"/auth/google",children:Object(pe.jsxs)("button",{type:"button",className:"google-button",children:[Object(pe.jsx)("span",{className:"google-button__icon",children:Object(pe.jsxs)("svg",{viewBox:"0 0 366 372",xmlns:"http://www.w3.org/2000/svg",children:[Object(pe.jsx)("path",{d:"M125.9 10.2c40.2-13.9 85.3-13.6 125.3 1.1 22.2 8.2 42.5 21 59.9 37.1-5.8 6.3-12.1 12.2-18.1 18.3l-34.2 34.2c-11.3-10.8-25.1-19-40.1-23.6-17.6-5.3-36.6-6.1-54.6-2.2-21 4.5-40.5 15.5-55.6 30.9-12.2 12.3-21.4 27.5-27 43.9-20.3-15.8-40.6-31.5-61-47.3 21.5-43 60.1-76.9 105.4-92.4z",id:"Shape",fill:"#EA4335"}),Object(pe.jsx)("path",{d:"M20.6 102.4c20.3 15.8 40.6 31.5 61 47.3-8 23.3-8 49.2 0 72.4-20.3 15.8-40.6 31.6-60.9 47.3C1.9 232.7-3.8 189.6 4.4 149.2c3.3-16.2 8.7-32 16.2-46.8z",id:"Shape",fill:"#FBBC05"}),Object(pe.jsx)("path",{d:"M361.7 151.1c5.8 32.7 4.5 66.8-4.7 98.8-8.5 29.3-24.6 56.5-47.1 77.2l-59.1-45.9c19.5-13.1 33.3-34.3 37.2-57.5H186.6c.1-24.2.1-48.4.1-72.6h175z",id:"Shape",fill:"#4285F4"}),Object(pe.jsx)("path",{d:"M81.4 222.2c7.8 22.9 22.8 43.2 42.6 57.1 12.4 8.7 26.6 14.9 41.4 17.9 14.6 3 29.7 2.6 44.4.1 14.6-2.6 28.7-7.9 41-16.2l59.1 45.9c-21.3 19.7-48 33.1-76.2 39.6-31.2 7.1-64.2 7.3-95.2-1-24.6-6.5-47.7-18.2-67.6-34.1-20.9-16.6-38.3-38-50.4-62 20.3-15.7 40.6-31.5 60.9-47.3z",fill:"#34A853"})]})}),Object(pe.jsx)("span",{className:"google-button__text",children:"Sign in with Google"})]})})})})]})})}));function he(){var e=Object(u.f)().pathname;return Object(l.useEffect)((function(){window.scrollTo(0,0)}),[e]),null}var be=n(7),me=n(5);function fe(e,t){return Object(pe.jsxs)("div",{className:"error-container",children:[Object(pe.jsx)("div",{className:"header-container",children:Object(pe.jsxs)("h1",{children:["Error:",e.statusCode]})}),Object(pe.jsx)("p",{className:"p-welcome",children:e.message}),Object(pe.jsx)(o.b,{className:"btn green-btn",to:"/",onClick:function(){t()},children:"Take me home"})]})}var Oe=n(18),xe=n.n(Oe),ve=n(37),ge=n.n(ve),ye=n(15),Ne=Object(c.b)((function(e){return{snippets:e.snippets,auth:e.auth}}),{postSnippet:te,fetchSnippet:function(){return function(){var e=Object(j.a)(p.a.mark((function e(t){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.get("/api/snippets");case 2:n=e.sent,t({type:T,payload:n.data.snippets});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},addSnippet:re,deleteSnippet:ne,clearError:se,clearAuthor:oe,clearSnippets:ue})((function(e){var t=e.postSnippet,n=e.fetchSnippet,r=e.snippets,a=e.addSnippet,c=e.auth,s=e.deleteSnippet,i=e.clearAuthor,u=e.clearSnippets,d=Object(ye.a)(),p=d.register,j=d.handleSubmit,h=d.errors,b=d.reset;Object(l.useEffect)((function(){var e=ge()("https://writers-desk.herokuapp.com");return e.on("snippets",(function(e){"create"===e.action&&a(e.snippet),"delete"===e.action&&n()})),function(){e.off("snippets")}}),[a,n,r.length]),Object(l.useEffect)((function(){n()}),[n]),Object(l.useEffect)((function(){return function(){u()}}),[u]);var m=function(e){t(e.snippetText),b()};return Object(pe.jsx)("div",{children:Object(pe.jsxs)("div",{className:"snippets-container story-item",children:[Object(pe.jsx)("div",{className:"snippet-header-container",children:Object(pe.jsx)("h3",{children:"Snippets"})}),Object(pe.jsx)("p",{className:"snippets-sub-header",children:"Let other writers know what you're up to, add a short snippet to the live feed."}),c?Object(pe.jsxs)("form",{className:"snippet-form",onSubmit:j(m),children:[Object(pe.jsx)("label",{name:"snippetText",for:"snippet-text",children:"Post a snippet"}),Object(pe.jsxs)("div",{className:"input-container",children:[Object(pe.jsx)("input",{name:"snippetText",ref:p({required:!0,maxLength:100}),className:"snippets-home-input",id:"snippet-text"}),Object(pe.jsx)("div",{className:"snippet-btn-container",children:Object(pe.jsx)("button",{className:"btn green-btn",type:"submit",children:"Post"})})]}),h.snippetText&&"maxLength"===h.snippetText.type&&Object(pe.jsx)("p",{className:"validation-warning",children:"Snippets have a max length of 100 characters"})]}):Object(pe.jsx)("p",{className:"snippets-sub-header",children:"Sign in to post a snippet"}),(r.length>10?r.slice(0,10):r).map((function(e){return Object(pe.jsxs)("div",{className:"snippet-container",children:[Object(pe.jsxs)("div",{className:"snippet-left",children:[Object(pe.jsx)("p",{className:"snippet-text",children:e.text}),Object(pe.jsx)("p",{className:"snippet-username",children:Object(pe.jsx)(o.b,{to:"/author/".concat(e._user),onClick:function(){return i()},children:e.username})})]}),Object(pe.jsx)("div",{className:"snippet-right",children:e._user===(null===c||void 0===c?void 0:c._id)?Object(pe.jsx)("button",{className:"btn delete-btn",onClick:function(){return s(e._id)},children:"Delete"}):null})]},e._id)})),Object(pe.jsx)("div",{className:"link-to-snippets",children:Object(pe.jsx)(o.b,{to:"/snippets/1",children:"See all snippets"})})]})})})),Se=function(e){var t=e.pager,n=e.currentPage,r=e.path,a=e.clearStore;return Object(pe.jsx)("div",{className:"paginate-container",children:Object(pe.jsxs)("ul",{children:[1!==t.currentPage&&1!==t.previousPage?Object(pe.jsx)("li",{children:Object(pe.jsx)(o.b,{to:"".concat(r,"1"),className:"".concat(1===n&&"active"," "),onClick:function(){return a()},children:"1"})}):null,t.hasPreviousPage?Object(pe.jsx)("li",{children:Object(pe.jsx)(o.b,{to:"".concat(r).concat(t.previousPage),onClick:function(){return a()},children:t.previousPage})}):null,Object(pe.jsx)("li",{children:Object(pe.jsx)(o.b,{to:"".concat(r).concat(t.currentPage),className:"active",onClick:function(){return a()},children:t.currentPage})}),t.hasNextPage?Object(pe.jsx)("li",{children:Object(pe.jsx)(o.b,{to:"".concat(r).concat(t.nextPage),onClick:function(){return a()},children:t.nextPage})}):null,t.lastPage!==t.currentPage&&t.nextPage!==t.lastPage&&0!==t.lastPage?Object(pe.jsx)("li",{children:Object(pe.jsx)(o.b,{to:"".concat(r).concat(t.lastPage),onClick:function(){return a()},children:t.lastPage})}):null]})})},Ee=Object(c.b)((function(e){return{stories:e.stories,pager:e.pager,error:e.error,message:e.message,loading:e.loading,storeStory:e.story}}),{fetchStories:function(e){return function(){var t=Object(j.a)(p.a.mark((function t(n){var r;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,b.a.get("/api/stories/?page="+e);case 2:r=t.sent,n({type:C,payload:r.data.pager}),n({type:m,payload:r.data.stories});case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},clearError:se,clearMessage:ce,clearStory:function(){return{type:W}},clearAuthor:oe,clearStories:ie,dropNav:ae,clearPagination:de})((function(e){var t=e.stories,n=e.fetchStories,r=e.pager,a=e.match,c=e.clearMessage,s=e.error,i=e.message,u=e.clearError,d=e.storeStory,p=e.clearStory,j=e.clearAuthor,h=e.clearStories,b=e.dropNav,m=e.clearPagination,f=Object(l.useState)(a.params.page),O=Object(me.a)(f,2),x=O[0],v=O[1],g=Object(l.useState)(!0),y=Object(me.a)(g,2),N=y[0],S=y[1];Object(l.useEffect)((function(){v(a.params.page||1)}),[v,a.params.page,x]),Object(l.useEffect)((function(){n(x||1)}),[x,n]),Object(l.useEffect)((function(){t.length>0&&S(!1),t.length<1&&S(!0)}),[t]),Object(l.useEffect)((function(){return function(){u()}}),[u]),Object(l.useEffect)((function(){return function(){c()}}),[c]),Object(l.useEffect)((function(){return function(){b(!1)}}),[b]),Object(l.useEffect)((function(){return function(){h()}}),[h]),Object(l.useEffect)((function(){return function(){m()}}),[m]);var E=function(e,t){t&&e!==t&&(p(),j())},w=function(){return function(){var e={},n=Object(be.a)(t);return n.splice(0,0,e),n.splice(1,0,e),n.splice(2,0,e),n}().map((function(e,t){return 0===t?Object(pe.jsx)("section",{className:"story-item-container",children:Object(pe.jsx)(o.b,{to:"/story/6076f50daa99aa3fc42a0d5f",onClick:function(){p(),j()},children:Object(pe.jsxs)("div",{className:"story-item featured-story",children:[Object(pe.jsx)("p",{className:"featured-text",children:"Featured Story"}),Object(pe.jsx)("h3",{children:"Shall I compare thee to a summer's day?"}),Object(pe.jsx)("p",{className:"story-page-author",children:"Posted by: Will Shakes P"}),Object(pe.jsx)("p",{className:"story-page-desc",children:"Thou will find 'tis the greatest poem I hath ever written. Tis about Summer and her splendid beauty. Please donate so I can buy more quills!"})]})})},t):1===t?Object(pe.jsx)("aside",{className:"story-item-container snippets-container",children:Object(pe.jsx)(Ne,{})},t):2===t?Object(pe.jsx)("div",{className:"story-item-container sub-header-container",children:Object(pe.jsx)("h2",{children:"Latest Stories"})},t):Object(pe.jsx)("section",{className:"story-item-container",children:Object(pe.jsx)(o.b,{to:"/story/".concat(e._id),onClick:function(){return E(e._id,null===d||void 0===d?void 0:d._id)},children:Object(pe.jsxs)("div",{className:"story-item",children:[Object(pe.jsx)("h3",{children:e.title}),Object(pe.jsxs)("p",{className:"story-page-author",children:["Posted by: ",e.username]}),Object(pe.jsx)("p",{className:"story-page-desc",children:e.description})]})})},t)}))};return Object(pe.jsxs)("div",{children:[function(){if(i)return Object(pe.jsx)("div",{className:"message-container",children:Object(pe.jsxs)("div",{className:"message",children:[Object(pe.jsx)("p",{children:i}),Object(pe.jsx)("button",{className:"btn notification-btn",onClick:function(){return c()},children:"Close"})]})})}(),s?fe(s,u):Object(pe.jsxs)("article",{className:"stories-container",children:[Object(pe.jsx)("div",{className:"header-container",children:Object(pe.jsx)("h1",{children:x&&1!==+x?"Latest Stories - Page ".concat(x):"Home"})}),Object(pe.jsxs)("p",{className:"p-welcome",children:["Welcome to ",Object(pe.jsx)("span",{children:"Writer's Desk"}),", a space for creative writers to share their work! Sign up and post your own stories and consider supporting other writers with a donation."]}),N?Object(pe.jsx)("div",{className:"loader",children:Object(pe.jsx)(xe.a,{type:"ThreeDots",color:"#ccd5ae",height:80,timeout:5e3})}):1===r.currentPage?Object(pe.jsx)("div",{className:"stories-grid author-stories-grid",children:w()}):Object(pe.jsx)("div",{className:"stories-grid stories-grid-2 author-stories-grid",children:t.map((function(e,t){return Object(pe.jsx)("section",{className:"story-item-container",children:Object(pe.jsx)(o.b,{to:"/story/".concat(e._id),onClick:function(){return E(e._id,null===d||void 0===d?void 0:d._id)},children:Object(pe.jsxs)("div",{className:"story-item",children:[Object(pe.jsx)("h3",{children:e.title}),Object(pe.jsxs)("p",{className:"story-page-author",children:["Posted by: ",e.username]}),Object(pe.jsx)("p",{className:"story-page-desc",children:e.description})]})})},t)}))}),N?null:Object(pe.jsx)(Se,{pager:r,currentPage:x,path:"/stories/",clearStore:h})]})]})})),we=Object(c.b)((function(e){return{auth:e.auth,story:e.story,error:e.error}}),{postStory:function(e,t){var n=e.title,r=e.description,a=e.content,c=e.creator;return function(){var e=Object(j.a)(p.a.mark((function e(s){var i,o;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.a.post("/api/create-story",{title:n,description:r,content:a,creator:c});case 3:i=e.sent,s({type:O,payload:i.data.story}),s({type:U,payload:i.data.msg}),t.push("/"),e.next=14;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0),o={statusCode:e.t0.response.status,message:e.t0.response.data.error,statusText:e.t0.response.data.statusText},s({type:L,payload:o});case 14:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}()},clearError:se,dropNav:ae})((function(e){var t=e.postStory,n=e.auth,r=e.history,a=e.error,c=e.clearError,s=e.dropNav,i=Object(l.useState)(!1),o=Object(me.a)(i,2),u=o[0],d=o[1],p=Object(ye.a)(),j=p.register,h=p.handleSubmit,b=p.errors;Object(l.useEffect)((function(){return function(){s(!1)}}),[s]);var m=function(e){var a=n._id,c=e.title,s=e.description,i=e.content;t({title:c,description:s,content:i,creator:a},r)},f=function(){if(u)return Object(pe.jsxs)("div",{className:"how-to-format-container",children:[Object(pe.jsxs)("p",{children:['Writer\'s Desk uses "marked" for formatting user stories. Most users only need to know that hitting the space button twice will format to a new line. ',Object(pe.jsx)("br",{}),"  For everything else however, check out the ",Object(pe.jsx)("span",{children:Object(pe.jsx)("a",{href:"https://marked.js.org/",children:"marked documentation"})})," for more detailed formatting options."]}),Object(pe.jsx)("button",{type:"button",className:"btn change-esc-btn",onClick:function(){return d(!1)},children:"X"})]})};return Object(pe.jsx)("div",{children:a?fe(a,c):Object(pe.jsxs)("div",{className:"add-story-container",children:[Object(pe.jsx)("div",{className:"header-container",children:Object(pe.jsx)("h1",{children:"Submit Your Story!"})}),Object(pe.jsx)("div",{className:"forms-container",children:Object(pe.jsxs)("form",{onSubmit:h(m),children:[Object(pe.jsx)("div",{className:"form-btn-container",children:Object(pe.jsx)("button",{type:"button",className:"btn htf-btn notification-btn",onClick:function(){return d(!u)},children:"How to format"})}),f(),Object(pe.jsxs)("div",{className:"add-story-input-title add-story-item-container",children:[Object(pe.jsx)("label",{for:"add-title",children:" Add a Title"}),Object(pe.jsx)("input",{name:"title",ref:j({required:!0,maxLength:100}),id:"add-title"}),b.title&&"required"===b.title.type&&Object(pe.jsx)("p",{className:"validation-warning",children:"This is Required"}),b.title&&"maxLength"===b.title.type&&Object(pe.jsx)("p",{className:"validation-warning",children:"Title should not be longer than 100 characters"})]}),Object(pe.jsxs)("div",{className:"add-story-input-description add-story-item-container",children:[Object(pe.jsx)("label",{for:"add-description",children:" Short description"}),Object(pe.jsx)("input",{name:"description",ref:j({required:!0,maxLength:200}),id:"add-description"}),b.description&&"required"===b.description.type&&Object(pe.jsx)("p",{className:"validation-warning",children:"This is Required"}),b.description&&"maxLength"===b.description.type&&Object(pe.jsx)("p",{className:"validation-warning",children:"Description should not be longer than 250 characters"})]}),Object(pe.jsxs)("div",{className:"add-story-input-content add-story-item-container",children:[Object(pe.jsx)("label",{for:"add-story",children:"Story"}),Object(pe.jsx)("textarea",{name:"content",id:"add-story",ref:j({required:!0,minLength:100,maxLength:1e4})}),b.content&&"required"===b.content.type&&Object(pe.jsx)("p",{className:"validation-warning",children:"This is Required"}),b.content&&"minLength"===b.content.type&&Object(pe.jsx)("p",{className:"validation-warning",children:"A story must have at least 100 characters"}),b.content&&"maxLength"===b.content.type&&Object(pe.jsx)("p",{className:"validation-warning",children:"The maximum length for a story is 10,000 characters"})]}),Object(pe.jsx)("div",{className:"form-btn-container",children:Object(pe.jsx)("button",{name:"submit-button",className:"green-btn btn",type:"submit",children:"Submit"})})]})})]})})})),ke=Object(c.b)((function(e){var t=e.author,n=e.auth,r=e.userStories;return{author:t,auth:n,pager:e.pager,userStories:r,error:e.error,message:e.message}}),{fetchAuthor:$,updateUsername:function(e){return function(){var t=Object(j.a)(p.a.mark((function t(n){var r,a;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n({type:v,payload:"Updating..."}),t.prev=1,t.next=4,b.a.put("/account/update-username",{username:e});case 4:r=t.sent,n({type:x,payload:r.data.user}),t.next=12;break;case 8:t.prev=8,t.t0=t.catch(1),a={statusCode:t.t0.response.status,message:t.t0.response.data.error,statusText:t.t0.response.data.statusText},n({type:L,payload:a});case 12:case"end":return t.stop()}}),t,null,[[1,8]])})));return function(e){return t.apply(this,arguments)}}()},updateUserDesc:function(e){return function(){var t=Object(j.a)(p.a.mark((function t(n){var r,a;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n({type:g,payload:"Updating..."}),t.prev=1,t.next=4,b.a.put("/account/update-desc",{description:e});case 4:r=t.sent,n({type:x,payload:r.data.user}),t.next=12;break;case 8:t.prev=8,t.t0=t.catch(1),a={statusCode:t.t0.response.status,message:t.t0.response.data.error,statusText:t.t0.response.data.statusText},n({type:L,payload:a});case 12:case"end":return t.stop()}}),t,null,[[1,8]])})));return function(e){return t.apply(this,arguments)}}()},fetchUserStories:K,clearError:se,deleteUser:function(e,t){return function(){var n=Object(j.a)(p.a.mark((function n(r){var a,c;return p.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,b.a.delete("/account/"+e);case 3:a=n.sent,r({type:R,payload:a.data.msg}),t.push("/"),n.next=13;break;case 8:n.prev=8,n.t0=n.catch(0),console.log(n.t0),c={statusCode:n.t0.response.status,message:n.t0.response.data.error,statusText:n.t0.response.data.statusText},r({type:L,payload:c});case 13:case"end":return n.stop()}}),n,null,[[0,8]])})));return function(e){return n.apply(this,arguments)}}()},clearMessage:ce,clearUserStories:le,dropNav:ae})((function(e){var t=e.userStories,n=e.auth,r=e.updateUsername,a=e.updateUserDesc,c=e.fetchUserStories,s=e.match,i=e.pager,u=e.clearError,d=e.error,p=e.deleteUser,j=e.history,h=e.clearMessage,b=e.message,m=e.clearUserStories,f=e.dropNav,O=Object(l.useState)(!0),x=Object(me.a)(O,2),v=x[0],g=x[1],y={username:n.username},N={description:n.description},S=Object(ye.a)({defaultValues:y}),E=S.register,w=S.handleSubmit,k=S.errors,T=Object(ye.a)({defaultValues:N}),C=T.register,_=T.errors,P=T.handleSubmit;Object(l.useEffect)((function(){return function(){f(!1)}}),[f]);var A=Object(l.useState)(!1),I=Object(me.a)(A,2),L=I[0],R=I[1],D=Object(l.useState)(!1),U=Object(me.a)(D,2),q=U[0],M=U[1],H=Object(l.useState)(!1),Y=Object(me.a)(H,2),B=Y[0],F=Y[1],G=Object(l.useState)(!1),z=Object(me.a)(G,2),W=z[0],X=z[1],V=Object(l.useState)(s.params.page),J=Object(me.a)(V,2),K=J[0],Z=J[1];Object(l.useEffect)((function(){Z(s.params.page)}),[Z,s.params.page]),Object(l.useEffect)((function(){n||Q()}),[n]),Object(l.useEffect)((function(){n._id&&c(K||1,n._id)}),[n._id,K,c]),Object(l.useEffect)((function(){t.length<1&&g(!0),t.length>0&&g(!1)}),[t.length]),Object(l.useEffect)((function(){return function(){u()}}),[u]);var $=function(e){r(e.username),R(!1)},ee=function(e){a(e.description),M(!1)},te=function(){if(n)return Object(pe.jsxs)("div",{className:"author-data-container user-data-container",children:[Object(pe.jsx)("div",{className:"header-container",children:Object(pe.jsx)("h1",{children:"Your Profile"})}),n.donationsRecieved||n.donationsSent?Object(pe.jsxs)("div",{className:"author-donations-container author-data-item",children:[n.donationsRecieved?Object(pe.jsxs)("p",{children:["Donations received:  \xa3",n.donationsRecieved]}):null,n.donationsSent?Object(pe.jsxs)("p",{children:["You have donated: \xa3",n.donationsSent," "]}):null]}):null,Object(pe.jsxs)("div",{className:"author-username-container author-data-item",children:[Object(pe.jsx)("p",{children:n?n.username?n.username:n.name:null}),Object(pe.jsx)("button",{className:"btn green-btn",onClick:function(){R(!L),X(!W)},children:"Edit Username"})]}),ne(),Object(pe.jsxs)("div",{className:"author-description-container  author-data-item",children:[Object(pe.jsx)("p",{children:n?n.description?n.description:"You don't have a description yet":null}),Object(pe.jsx)("button",{className:"btn green-btn",onClick:function(){M(!q),X(!W)},children:n.description?"Edit Description":"Add Description"})]}),re(),Object(pe.jsxs)("div",{className:"author-delete-container\n                      author-data-item\n                      ".concat(B&&"hide"),children:[Object(pe.jsx)("p",{children:"Delete your profile"}),Object(pe.jsx)("button",{className:"btn danger-btn",onClick:function(){F(!0),X(!0)},children:"DELETE"})]}),ae()]})},ne=function(){if(n)return Object(pe.jsxs)("div",{className:"update-info-container author-data-item ".concat(L&&"active"),children:[Object(pe.jsx)("button",{className:"change-esc-btn btn",onClick:function(){R(!1),X(!1)},children:"X"}),Object(pe.jsxs)("form",{onSubmit:w($),children:[Object(pe.jsx)("label",{for:"edit-username",children:"Change Username: "}),Object(pe.jsxs)("div",{className:"input-container",children:[Object(pe.jsx)("input",{id:"edit-username",name:"username",ref:E({required:!0,maxLength:30})}),Object(pe.jsx)("div",{className:"submit-btn-container",children:Object(pe.jsx)("button",{type:"submit",className:"btn green-btn",children:"Submit"})})]}),k.username&&"required"===k.username.type&&Object(pe.jsx)("p",{className:"validation-warning",children:"Required"}),k.username&&"maxLength"===k.username.type&&Object(pe.jsx)("p",{className:"validation-warning",children:"Username should not be longer than 30 characters"})]})]})},re=function(){if(n)return Object(pe.jsxs)("div",{className:"update-info-container author-data-item ".concat(q&&"active"),children:[Object(pe.jsx)("button",{className:"change-esc-btn btn",onClick:function(){M(!1),X(!1)},children:"X"}),Object(pe.jsxs)("form",{onSubmit:P(ee),children:[Object(pe.jsx)("label",{for:"edit-description",children:n.description?"Edit your description":"Add a description to your profile"}),Object(pe.jsxs)("div",{className:"input-container",children:[Object(pe.jsx)("input",{id:"edit-description",name:"description",ref:C({required:!0,minLength:5,maxLength:100})}),Object(pe.jsx)("div",{className:"submit-btn-container",children:Object(pe.jsx)("button",{type:"submit",className:"btn green-btn",children:"Submit"})})]}),_.description&&"required"===_.description.type&&Object(pe.jsx)("p",{className:"validation-warning",children:"Required"}),_.description&&"maxLength"===_.description.type&&Object(pe.jsx)("p",{className:"validation-warning",children:"Description should not be longer than 100 characters"}),_.description&&"minLength"===_.description.type&&Object(pe.jsx)("p",{className:"validation-warning",children:"Descriptions must have at least 5 characters"})]})]})},ae=function(){return Object(pe.jsxs)("div",{className:"update-info-container author-data-item ".concat(B&&"active"),children:[Object(pe.jsx)("button",{className:"change-esc-btn btn",onClick:function(){F(!1),X(!1)},children:"X"}),Object(pe.jsx)("p",{className:"author-delete-text",children:"Are you sure you want to delete your profile? All your data will be removed permenantly "}),Object(pe.jsx)("div",{className:"submit-btn-container",children:Object(pe.jsx)("button",{className:"btn danger-btn",onClick:function(){p(n._id,j)},children:"Yes, Delete My Profile"})})]})};return Object(pe.jsxs)("div",{children:[function(){if(b)return Object(pe.jsxs)("div",{className:"message-container",children:[Object(pe.jsx)("p",{children:b}),Object(pe.jsx)("button",{onClick:function(){return h()},children:"Close"})]})}(),d?fe(d,u):Object(pe.jsxs)("div",{className:"author-page-container",children:[Object(pe.jsx)("div",{className:"change-details-bg-container ".concat(W&&"active"," ")}),te(),Object(pe.jsx)("div",{className:"header-container sub-header-container",children:Object(pe.jsx)("h2",{children:K&&1!==K?"Your Stories - Page ".concat(K):"Your Stories"})}),v?Object(pe.jsx)("div",{className:"loader loader-author",children:Object(pe.jsx)(xe.a,{type:"ThreeDots",color:"#ccd5ae",height:80,timeout:5e3})}):Object(pe.jsx)("div",{className:"stories-grid author-stories-grid",children:t?t.map((function(e){return Object(pe.jsx)("section",{className:"story-item-container",children:Object(pe.jsx)(o.b,{to:"/story/".concat(e._id),children:Object(pe.jsxs)("div",{className:"story-item",children:[Object(pe.jsx)("h3",{children:e.title}),Object(pe.jsxs)("p",{className:"story-page-author",children:["Posted by: ",e.username]}),Object(pe.jsx)("p",{className:"story-page-desc",children:e.description})]})})},e._id)})):null}),v?null:Object(pe.jsx)(Se,{pager:i,currentPage:K,path:"/your-profile/",clearStore:m})]})]})})),Te=Object(c.b)((function(e){return{story:e.story,auth:e.auth,error:e.error}}),{updateStoryComments:function(e,t){return function(){var n=Object(j.a)(p.a.mark((function n(r){var a,c;return p.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,b.a.post("/api/stories/comments/".concat(e),{commentText:t});case 3:a=n.sent,r({type:w,payload:a.data.comment}),n.next=11;break;case 7:n.prev=7,n.t0=n.catch(0),c={statusCode:n.t0.response.status,message:n.t0.response.data.error,statusText:n.t0.response.data.statusText},r({type:L,payload:c});case 11:case"end":return n.stop()}}),n,null,[[0,7]])})));return function(e){return n.apply(this,arguments)}}()},deleteStoryComment:function(e,t){return function(){var n=Object(j.a)(p.a.mark((function n(r){var a;return p.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,b.a.delete("/api/stories/comments/".concat(e,"/").concat(t));case 3:r({type:q,payload:t}),n.next=11;break;case 6:n.prev=6,n.t0=n.catch(0),console.log(n.t0),a={statusCode:n.t0.response.status,message:n.t0.response.data.error,statusText:n.t0.response.data.statusText},r({type:L,payload:a});case 11:case"end":return n.stop()}}),n,null,[[0,6]])})));return function(e){return n.apply(this,arguments)}}()},fetchStory:Z,clearError:se,clearAuthor:oe})((function(e){var t=e.story,n=e.updateStoryComments,r=e.auth,a=e.deleteStoryComment,c=e.clearAuthor,s=Object(ye.a)(),i=s.register,u=s.handleSubmit,d=s.errors,h=s.reset,b=Object(l.useState)(!1),m=Object(me.a)(b,2),f=m[0],O=m[1],x=Object(l.useState)(1),v=Object(me.a)(x,2),g=v[0],y=v[1],N=Object(l.useState)(null),S=Object(me.a)(N,2),E=S[0],w=S[1],k=function(){var e=Object(j.a)(p.a.mark((function e(r){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:O(!0),n(t._id,r.commentText),h();case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();Object(l.useEffect)((function(){return function(){if(t.comments&&!E){t.comments.reverse();var e=5*(g-1),n=t.comments.slice(e,e+5);w(n)}else if(t.comments){var r=5*(g-1),a=t.comments.slice(r,r+5);w(a)}}(),O(!1),function(){w(null)}}),[g,t,O]);return Object(pe.jsxs)("div",{className:"comments-container",children:[Object(pe.jsx)("div",{className:"sub-header-container",children:Object(pe.jsx)("h2",{children:"Comments"})}),r?Object(pe.jsxs)("form",{onSubmit:u(k),children:[Object(pe.jsx)("label",{for:"add-comment",children:"Add a Comment"}),Object(pe.jsxs)("div",{className:"input-container",children:[Object(pe.jsx)("input",{name:"commentText",ref:i({required:!0,maxLength:100}),id:"add-comment"}),Object(pe.jsx)("button",{type:"submit",className:"btn green-btn",children:"Post"})]}),d.commentText&&"maxLength"===d.commentText.type&&Object(pe.jsx)("p",{className:"validation-warning",children:"Comments have a max length of 100 characters"})]}):Object(pe.jsx)("div",{children:Object(pe.jsx)("p",{className:"story-comment-auth-msg",children:"Sign in to post a comment"})}),Object(pe.jsx)("ul",{className:"comments-list",children:f?Object(pe.jsx)("div",{className:"loader loader-comments",children:Object(pe.jsx)(xe.a,{type:"ThreeDots",color:"#ccd5ae",height:80,timeout:3e3})}):E?E.length>0?E.map((function(e){return Object(pe.jsxs)("li",{className:"comment-container",children:[Object(pe.jsxs)("div",{className:"comment-left",children:[Object(pe.jsx)("p",{className:"comment-text",children:e.commentText}),Object(pe.jsx)("p",{className:"comment-user",children:Object(pe.jsx)(o.b,{to:"/author/".concat(e.userId),onClick:function(){return c()},children:e.username})})]}),Object(pe.jsx)("div",{className:"comment-right",children:e.userId===r._id?Object(pe.jsx)("button",{onClick:function(){var n,r;n=t._id,r=e.id,a(n,r),O(!0)},className:"btn delete-btn",children:"Delete"}):null})]},e.id)})):E&&0!==E.length?void 0:Object(pe.jsx)("div",{className:"no-comments-container",children:Object(pe.jsx)("p",{children:"No comments yet!"})}):Object(pe.jsx)("div",{className:"no-comments-container",children:Object(pe.jsx)("p",{children:"No comments yet!"})})}),function(){if(t.comments){var e=t.comments.length,n=Math.ceil(t.comments.length/5),r=g,a=5*g<e,c=g+1,s=g>1,i=g-1,o=n;return Object(pe.jsx)("div",{className:"paginate-container pg-comments",children:Object(pe.jsxs)("ul",{children:[1!==r&&1!==i?Object(pe.jsx)("li",{className:"comment-li",children:Object(pe.jsx)("button",{onClick:function(){return y(1)},children:"1"})}):null,s?Object(pe.jsx)("li",{className:"comment-li",children:Object(pe.jsx)("button",{onClick:function(){return y(i)},children:i})}):null,Object(pe.jsx)("li",{className:"comment-li",children:Object(pe.jsx)("button",{onClick:function(){return y(r)},children:r})}),a?Object(pe.jsx)("li",{className:"comment-li",children:Object(pe.jsx)("button",{onClick:function(){return y(c)},children:c})}):null,o!==r&&c!==o&&0!==o?Object(pe.jsx)("li",{className:"comment-li",children:Object(pe.jsx)("button",{onClick:function(){return y(o)},children:o})}):null]})})}}()]})})),Ce=Object(c.b)((function(e){return{story:e.story,author:e.author,auth:e.auth,error:e.error,message:e.message}}),{fetchStory:Z,fetchAuthor:$,deleteStory:function(e){return function(){var t=Object(j.a)(p.a.mark((function t(n){var r;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,b.a.delete("/api/stories/".concat(e));case 3:n({type:"DELETE_STORY",payload:e}),n({type:U,payload:"Story Deleted"}),t.next=12;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0),r={statusCode:t.t0.response.status,message:t.t0.response.data.error,statusText:t.t0.response.data.statusText},n({type:L,payload:r});case 12:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()},clearError:se,clearMessage:ce,dropNav:ae})((function(e){var t=e.match,n=e.story,r=e.fetchStory,a=e.fetchAuthor,c=e.author,s=e.deleteStory,i=e.auth,u=e.history,d=e.clearError,h=e.error,b=e.message,m=e.clearMessage,f=e.dropNav,O=Object(l.useState)(!1),x=Object(me.a)(O,2),v=x[0],g=x[1],y=Object(l.useState)(!0),N=Object(me.a)(y,2),S=N[0],E=N[1];Object(l.useEffect)((function(){n||r(t.params.storyId)}),[n,r,t.params.storyId]),Object(l.useEffect)((function(){n&&!c&&n._user&&a(n._user)}),[n,a,c]),Object(l.useEffect)((function(){n&&c&&E(!1)}),[n,c,E]),Object(l.useEffect)((function(){return function(){d()}}),[d]),Object(l.useEffect)((function(){return function(){m()}}),[m]),Object(l.useEffect)((function(){return function(){f(!1)}}),[f]);var w=function(e){return e.username?e.username:e.name},k=function(){var e=Object(j.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s(t);case 2:u.push("/your-profile");case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),T=function(){if(v)return Object(pe.jsx)("div",{className:"message-container",children:Object(pe.jsxs)("div",{className:"message warning-message",children:[Object(pe.jsx)("p",{children:"Are you sure you want to delete your story?"}),Object(pe.jsx)("button",{className:"btn danger-btn",onClick:function(){return k(n._id)},children:"delete"}),Object(pe.jsx)("button",{className:"btn change-esc-btn \r cancel-delete-story-btn",onClick:function(){return g(!1)},children:"X"})]})})},C=function(){if(n&&i)return n._user===i._id?Object(pe.jsxs)("div",{className:"story-edit-btns",children:[Object(pe.jsxs)("div",{className:"story-btns-container",children:[Object(pe.jsx)(o.b,{className:"btn green-btn",to:"/edit-story/".concat(n._id),children:"edit"}),Object(pe.jsx)("button",{className:"btn delete-btn",onClick:function(){return g(!0)},children:"delete"})]}),T()]}):Object(pe.jsxs)("div",{className:"story-donate-btns-container",children:[Object(pe.jsx)("p",{children:"Like the story?"}),Object(pe.jsx)(o.b,{to:"/payment/".concat(c._id),className:"btn green-btn",children:"Donate"})]})};return Object(pe.jsxs)("article",{children:[function(){if(b)return Object(pe.jsx)("div",{className:"message-container",children:Object(pe.jsxs)("div",{className:"message",children:[Object(pe.jsx)("p",{children:b}),Object(pe.jsx)("button",{className:"btn notification-btn",onClick:function(){return m()},children:"Close"})]})})}(),h?fe(h,d):S?Object(pe.jsx)("div",{className:"loader loader-margin",children:Object(pe.jsx)(xe.a,{type:"ThreeDots",color:"#ccd5ae",height:80,timeout:5e3})}):Object(pe.jsx)("div",{children:c&&n?Object(pe.jsxs)("div",{className:"story-page-container",children:[Object(pe.jsx)("div",{className:"header-container",children:Object(pe.jsx)("h1",{children:n.title})}),C(),Object(pe.jsx)("p",{children:n.creator}),Object(pe.jsx)("p",{className:"story-page-desc",children:n.description}),Object(pe.jsx)("div",{className:"author-container",children:Object(pe.jsxs)("p",{children:["Written By:",Object(pe.jsx)(o.b,{to:"/author/".concat(n._user),children:Object(pe.jsxs)("span",{children:[" ",w(c)]})})]})}),Object(pe.jsxs)("div",{className:"story-page-grid",children:[Object(pe.jsx)("div",{className:"story-page-main-item grid-item",children:Object(pe.jsx)("p",{dangerouslySetInnerHTML:{__html:"".concat(n.sanitizedHtml)},className:"story-page-story"})}),Object(pe.jsx)("div",{className:"story-page-sub-item grid-item",children:Object(pe.jsx)(Te,{})})]})]}):null})]})})),_e=Object(c.b)((function(e){return{author:e.author,auth:e.auth,userStories:e.userStories,pager:e.pager,error:e.error}}),{fetchAuthorBasic:ee,fetchUserStories:K,clearError:se,clearUserStories:le,dropNav:ae,clearPagination:de})((function(e){var t=e.author,n=e.match,r=e.fetchUserStories,a=e.userStories,c=e.fetchAuthorBasic,s=e.pager,i=e.error,u=e.clearError,d=e.clearUserStories,p=e.dropNav,j=e.clearPagination,h=Object(l.useState)(n.params.page),b=Object(me.a)(h,2),m=b[0],f=b[1],O=Object(l.useState)(!0),x=Object(me.a)(O,2),v=x[0],g=x[1];Object(l.useEffect)((function(){f(n.params.page||1)}),[f,n.params.page,m]),Object(l.useEffect)((function(){t||c(n.params.authorId)}),[c,n.params.authorId,t]),Object(l.useEffect)((function(){r(m||1,n.params.authorId)}),[m,n.params.authorId,r]),Object(l.useEffect)((function(){t&&g(!1)}),[v,t]),Object(l.useEffect)((function(){return function(){j()}}),[j]),Object(l.useEffect)((function(){return function(){d()}}),[d]),Object(l.useEffect)((function(){return function(){p(!1)}}),[p]);var y=function(){return t?t.username?t.username:t.name:null};return Object(pe.jsx)("div",{children:i?fe(i,u):v?Object(pe.jsx)("div",{className:"loader loader-margin",children:Object(pe.jsx)(xe.a,{type:"ThreeDots",color:"#ccd5ae",height:80,timeout:5e3})}):Object(pe.jsxs)("div",{className:"author-page-container",children:[t?Object(pe.jsxs)("div",{className:"author-data-container",children:[Object(pe.jsx)("div",{className:"header-container",children:Object(pe.jsx)("h1",{children:y()})}),Object(pe.jsx)("p",{children:t&&t.description?t.description:null}),Object(pe.jsx)(o.b,{to:"/payment/".concat(t._id),className:"btn green-btn",children:"Donate"}),Object(pe.jsxs)("div",{className:"author-donations-container",children:[t.donationsRecieved?Object(pe.jsxs)("p",{children:[y()," has received :  \xa3",t.donationsRecieved," from other users!"]}):null,t.donationsSent?Object(pe.jsxs)("p",{children:[y()," has dontated  \xa3",t.donationsSent," to other authors!"]}):null]})]}):null,Object(pe.jsx)("div",{className:"header-container sub-header-container",children:Object(pe.jsx)("h2",{children:m&&1!==m?"".concat(y(),"'s Stories - Page ").concat(m):"".concat(y(),"'s Stories ")})}),Object(pe.jsx)("div",{className:"stories-grid author-stories-grid",children:t&&a?a.map((function(e){return Object(pe.jsx)("section",{className:"story-item-container author-story-container",children:Object(pe.jsx)(o.b,{to:"/story/".concat(e._id),children:Object(pe.jsxs)("div",{className:"story-item",children:[Object(pe.jsx)("h3",{children:e.title}),Object(pe.jsxs)("p",{className:"story-page-author",children:["Posted by: ",e.username]}),Object(pe.jsx)("p",{className:"story-page-desc",children:e.description})]})})},e._id)})):null}),v?null:Object(pe.jsx)(Se,{pager:s,currentPage:m,path:"/author/".concat(n.params.authorId,"/"),clearStore:d})]})})})),Pe=Object(c.b)((function(e){return{auth:e.auth,story:e.story,error:e.error}}),{editStory:function(e,t){var n=e.storyId,r=e.title,a=e.description,c=e.content;return function(){var e=Object(j.a)(p.a.mark((function e(s){var i,o;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b.a.put("/api/stories/"+n,{title:r,description:a,content:c});case 3:i=e.sent,s({type:P,payload:i.data.story}),s({type:U,payload:i.data.msg}),t.push("/story/"+n),e.next=14;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0),o={statusCode:e.t0.response.status,message:e.t0.response.data.error,statusText:e.t0.response.data.statusText},s({type:L,payload:o});case 14:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}()},clearError:se,dropNav:ae})((function(e){var t=e.story,n=e.editStory,r=e.history,a=e.match,c=e.error,s=e.dropNav;Object(l.useEffect)((function(){t||Z(a.params.storyId)}),[t,a.params.storyId]),Object(l.useEffect)((function(){return function(){s(!1)}}),[s]);var i={title:(null===t||void 0===t?void 0:t.title)||"",description:(null===t||void 0===t?void 0:t.description)||"",content:(null===t||void 0===t?void 0:t.content)||""},o=Object(ye.a)({defaultValues:i}),u=o.register,d=o.handleSubmit,p=o.errors,j=function(e){var t=a.params.storyId,c=e.title,s=e.description,i=e.content;n({title:c,description:s,content:i,storyId:t},r)};return Object(pe.jsx)("div",{children:c?fe(c,se):Object(pe.jsx)("div",{className:"add-story-container",children:Object(pe.jsx)("div",{className:"forms-container",children:Object(pe.jsxs)("form",{onSubmit:d(j),children:[Object(pe.jsx)("div",{className:"header-container",children:Object(pe.jsx)("h1",{children:"Edit Your Story!"})}),Object(pe.jsxs)("div",{className:"add-story-input-title add-story-item-container",children:[Object(pe.jsx)("label",{for:"edit-title",children:" Edit Title"}),Object(pe.jsx)("input",{id:"edit-title",name:"title",ref:u({required:!0,maxLength:100})}),p.title&&"required"===p.title.type&&Object(pe.jsx)("p",{children:"This is required"}),p.title&&"maxLength"===p.title.type&&Object(pe.jsx)("p",{children:"Title should not be longer than 100 characters"})]}),Object(pe.jsxs)("div",{className:"add-story-input-description add-story-item-container",children:[Object(pe.jsx)("label",{for:"edit-description",children:" Edit description"}),Object(pe.jsx)("input",{id:"edit-description",name:"description",ref:u({required:!0,maxLength:200})}),p.description&&"required"===p.description.type&&Object(pe.jsx)("p",{children:"Required"}),p.description&&"maxLength"===p.description.type&&Object(pe.jsx)("p",{children:"Description should not be longer than 250 characters"})]}),Object(pe.jsxs)("div",{className:"add-story-input-content add-story-item-container",children:[Object(pe.jsx)("label",{for:"edit-story",children:"Edit Story"}),Object(pe.jsx)("textarea",{id:"edit-story",name:"content",ref:u({required:!0,minLength:100,maxLength:1e4})}),p.content&&"required"===p.content.type&&Object(pe.jsx)("p",{children:"Required"}),p.content&&"minLength"===p.content.type&&Object(pe.jsx)("p",{children:"A story must have at least 100 characters"}),p.content&&"maxLength"===p.content.type&&Object(pe.jsx)("p",{children:"The maximum length for a story is 10,000 characters"})]}),Object(pe.jsx)("div",{className:"form-btn-container",children:Object(pe.jsx)("button",{name:"submit-button",className:"green-btn btn",type:"submit",children:"Submit"})})]})})})})})),Ae=Object(c.b)((function(e){return{snippets:e.snippets,auth:e.auth,pager:e.pager,error:e.error}}),{postSnippet:te,fetchAllSnippets:function(e){return function(){var t=Object(j.a)(p.a.mark((function t(n){var r;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,b.a.get("/api/all-snippets/?page="+e);case 2:r=t.sent,n({type:T,payload:r.data.snippets}),n({type:C,payload:r.data.pager});case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},addSnippet:re,deleteSnippet:ne,displayError:fe,clearError:se,clearSnippets:ue,dropNav:ae,clearPagination:de})((function(e){var t=e.postSnippet,n=e.fetchAllSnippets,r=e.snippets,a=e.addSnippet,c=e.auth,s=e.deleteSnippet,i=e.pager,u=e.match,d=e.error,p=e.clearError,j=e.clearSnippets,h=e.history,b=e.dropNav,m=e.clearPagination,f=Object(ye.a)(),O=f.register,x=f.handleSubmit,v=f.errors,g=f.reset,y=Object(l.useState)(u.params.page),N=Object(me.a)(y,2),S=N[0],E=N[1],w=Object(l.useState)(!0),k=Object(me.a)(w,2),T=k[0],C=k[1];Object(l.useEffect)((function(){E(u.params.page||1)}),[E,u.params.page,S]),Object(l.useEffect)((function(){var e=ge()("https://writers-desk.herokuapp.com");return e.on("snippets",(function(e){"create"===e.action&&a(e.snippet),"delete"===e.action&&n()})),function(){e.off("snippets")}}),[n,a]),Object(l.useEffect)((function(){n(S||1)}),[S,n]),Object(l.useEffect)((function(){r.length>0&&C(!1),r.length<1&&C(!0)}),[r]),Object(l.useEffect)((function(){return function(){b(!1)}}),[b]),Object(l.useEffect)((function(){return function(){m()}}),[m]);var _=function(e){t(e.snippetText),g(),j(),h.push("/snippets/1")};return Object(pe.jsx)("div",{children:d?fe(d,p):Object(pe.jsxs)("div",{className:"all-snippets-container snippets-container",children:[Object(pe.jsx)("div",{className:"header-container snippets-header",children:Object(pe.jsx)("h1",{children:"All Snippets"})}),Object(pe.jsx)("p",{className:"snippets-sub-header",children:"Let other writers know what you're up to, add a short snippet to the live feed."}),c?Object(pe.jsxs)("form",{className:"snippet-form",onSubmit:x(_),children:[Object(pe.jsx)("label",{for:"add-snippet",children:"Post a snippet"}),Object(pe.jsxs)("div",{className:"input-container",children:[Object(pe.jsx)("input",{name:"snippetText",id:"add-snippet",ref:O({required:!0,maxLength:100}),className:"snippets-home-input"}),Object(pe.jsx)("div",{className:"snippet-btn-container",children:Object(pe.jsx)("button",{className:"btn green-btn",type:"submit",children:"Post"})})]}),v.snippetText&&"maxLength"===v.snippetText.type&&Object(pe.jsx)("p",{className:"validation-warning",children:"Snippets have a max length of 100 characters"})]}):Object(pe.jsx)("p",{className:"snippets-sub-header",children:"Sign in to post a snippet"}),T?Object(pe.jsx)("div",{className:"loader loader-margin",children:Object(pe.jsx)(xe.a,{type:"ThreeDots",color:"#ccd5ae",height:80,timeout:1e5})}):Object(pe.jsx)("div",{className:"snippets-list",children:(r.length>10?r.slice(0,10):r).map((function(e){return Object(pe.jsxs)("section",{className:"snippet-container",children:[Object(pe.jsxs)("div",{className:"snippet-left",children:[Object(pe.jsx)("p",{className:"snippet-text",children:e.text}),Object(pe.jsx)("p",{className:"snippet-username",children:Object(pe.jsx)(o.b,{to:"/author/".concat(e._user),children:e.username})})]}),Object(pe.jsx)("div",{className:"snippet-right",children:e._user===(null===c||void 0===c?void 0:c._id)?Object(pe.jsx)("button",{className:"btn delete-btn",onClick:function(){return s(e._id)},children:"Delete"}):null})]},e._id)}))}),T?null:Object(pe.jsx)(Se,{pager:i,currentPage:S,path:"/snippets/",clearStore:j})]})})})),Ie=n(73),Le=Object(Ie.a)("pk_test_51HopnLK7csUlSCmRxKe3WpdUYwBenxozM3UsaiprA9Zz1RtER9LQjM0HkINbs6r5XmaOmD7jsPolMqGzOC7Lgxbx00y8ePgpuu"),Re=function(e){var t=e.handleClick,n=e.amount,r=e.setAmount;return Object(pe.jsxs)("div",{className:"payment-before",children:[Object(pe.jsx)("div",{className:"header-container",children:Object(pe.jsx)("h1",{children:"Support the author with a donation!"})}),Object(pe.jsx)("label",{for:"donation-amount",children:"Select an Amount"}),Object(pe.jsxs)("select",{value:n,onChange:function(e){return r(e.target.value)},id:"donation-amount",children:[Object(pe.jsx)("option",{value:"1",children:"\xa31"}),Object(pe.jsx)("option",{value:"2",children:"\xa32"}),Object(pe.jsx)("option",{value:"3",children:"\xa33"}),Object(pe.jsx)("option",{value:"4",children:"\xa34"}),Object(pe.jsx)("option",{value:"5",children:"\xa35"})]}),Object(pe.jsx)("button",{type:"button",id:"checkout-button",role:"link",onClick:t,className:"btn green-btn",children:"Checkout"})]})},De=function(e){var t=e.message;return Object(pe.jsxs)("section",{className:"payment-after",children:[Object(pe.jsx)("p",{children:t}),Object(pe.jsx)(o.b,{to:"/",children:"Back to HomePage"})]})},Ue=Object(c.b)((function(e){return{author:e.author,auth:e.auth}}),{fetchAuthorBasic:ee,postPayment:function(e,t,n,r){return function(){var a=Object(j.a)(p.a.mark((function a(c){var s,i;return p.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,b.a.post("/post-payment-data",{amount:e,authorId:t,userId:n,paymentId:r});case 3:s=a.sent,c({type:M,payload:s.data.user}),a.next=11;break;case 7:a.prev=7,a.t0=a.catch(0),i={statusCode:a.t0.response.status,message:a.t0.response.data.error,statusText:a.t0.response.data.statusText},c({type:L,payload:i});case 11:case"end":return a.stop()}}),a,null,[[0,7]])})));return function(e){return a.apply(this,arguments)}}()},clearError:se,dropNav:ae})((function(e){var t=e.author,n=e.match,r=e.fetchAuthorBasic,a=e.auth,c=e.postPayment,s=e.clearError,i=e.dropNav,o=Object(l.useState)(1),u=Object(me.a)(o,2),d=u[0],h=u[1],m=Object(l.useState)(""),f=Object(me.a)(m,2),O=f[0],x=f[1];Object(l.useEffect)((function(){return function(){s()}}),[s]),Object(l.useEffect)((function(){t||r(n.params.authorId)}),[t,r,n.params.authorId]),Object(l.useEffect)((function(){return function(){i(!1)}}),[i]),Object(l.useEffect)((function(){var e=t?t.username?t.username:t.name:"",s=new URLSearchParams(window.location.search),i=s.get("amount")/100,o=s.get("paymentId");if(s.get("success")&&(x(t?"Your donation of \xa3".concat(i," to ").concat(e," was successful \ud83d\ude42"):"LOADING"),t&&a)){var u=t._id,l=a._id;c(i,u,l,o)}if(s.get("canceled")&&x("Payment Cancelled."),!t&&!s.get("canceled"))if(n.params.authorId)r(n.params.authorId);else{var d=s.get("authorId");r(d)}}),[t]);var v=function(){var e=Object(j.a)(p.a.mark((function e(n){var r,a,c,s,i;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Le;case 2:return r=e.sent,a=t._id,e.next=6,b.a.post("/create-checkout-session",{amount:d,authorId:a});case 6:return c=e.sent,e.next=9,c.data;case 9:return s=e.sent,e.next=12,r.redirectToCheckout({sessionId:s.id});case 12:if(!(i=e.sent).error){e.next=15;break}return e.abrupt("return",Object(pe.jsx)("p",{children:i.error.message}));case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return O?Object(pe.jsx)(De,{message:O}):Object(pe.jsx)(Re,{handleClick:v,setAmount:h,amount:d})})),qe=function(){return Object(pe.jsx)("footer",{children:Object(pe.jsx)("div",{className:"footer-container",children:Object(pe.jsx)("a",{href:"https://github.com/64-bit-david",children:"Created By David Williamson"})})})},Me=function(){return Object(pe.jsx)("div",{className:"err-pg-not-found",children:Object(pe.jsxs)("div",{className:"header-container",children:[Object(pe.jsx)("h1",{children:"Error 404: Page not found.."}),Object(pe.jsx)("div",{children:Object(pe.jsx)(o.b,{to:"/",className:"btn green-btn",children:"Take me home"})})]})})},He=function(){return Object(pe.jsx)("div",{className:"body-container",children:Object(pe.jsxs)(o.a,{children:[Object(pe.jsx)(he,{}),Object(pe.jsx)(je,{}),Object(pe.jsx)("main",{className:"main",children:Object(pe.jsxs)(u.c,{children:[Object(pe.jsx)(u.a,{path:"/",exact:!0,component:Ee}),Object(pe.jsx)(u.a,{path:"/stories/:page",component:Ee}),Object(pe.jsx)(u.a,{path:"/add-story",component:we}),Object(pe.jsx)(u.a,{path:"/edit-story/:storyId",component:Pe}),Object(pe.jsx)(u.a,{path:"/story/:storyId",component:Ce}),Object(pe.jsx)(u.a,{path:"/author/:authorId",exact:!0,component:_e}),Object(pe.jsx)(u.a,{path:"/author/:authorId/:page",component:_e}),Object(pe.jsx)(u.a,{path:"/your-profile/:page",exact:!0,component:ke}),Object(pe.jsx)(u.a,{path:"/your-profile",exact:!0,component:ke}),Object(pe.jsx)(u.a,{path:"/snippets/:page",exact:!0,component:Ae}),Object(pe.jsx)(u.a,{path:"/payment/",exact:!0,component:Ue}),Object(pe.jsx)(u.a,{path:"/payment/:authorId",component:Ue}),Object(pe.jsx)(u.a,{component:Me})]})}),Object(pe.jsx)(qe,{})]})})};var Ye=n(13),Be=n(26);var Fe=function(e,t){var n=[t.payload].concat(Object(be.a)(e));return n.pop(),n};var Ge=function(e,t){var n=Object(Be.a)({},e);return n.comments?n.comments.unshift(t.payload):n.comments=[t.payload],n},ze=function(e,t){var n=Object(Be.a)({},e);return n.comments=n.comments.filter((function(e){return e.id!==t.payload})),n};var We=Object(s.c)({stories:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case m:return t.payload;case O:return Fe(e,t);case F:return[];default:return e}},auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case f:return t.payload||!1;case x:return t.payload;case v:return Object(Be.a)(Object(Be.a)({},e),{},Object(Ye.a)({},e.username,t.payload));case g:return Object(Be.a)(Object(Be.a)({},e),{},Object(Ye.a)({},e.description,t.payload));case M:return t.payload;case R:return console.log("deletion reached auth reducer"),null;default:return e}},story:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case N:case y:case P:return t.payload;case w:return Ge(e,t);case q:return ze(e,t);case A:return{};case W:return null;default:return e}},author:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case S:case E:return t.payload;case A:case z:return null;default:return e}},snippets:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case T:return t.payload;case k:return[t.payload].concat(Object(be.a)(e));case _:return e.filter((function(e){return e._id!==t.payload}));case X:return[];default:return e}},pager:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case C:return t.payload;case J:return{};default:return e}},userStories:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case I:return t.payload;case A:case F:case V:return[];default:return e}},error:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case L:return t.payload;case G:return null;default:return e}},message:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case R:case U:return t.payload;case D:return null;default:return e}},loading:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case B:return t.payload;case A:return null;default:return e}},navStatus:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case H:return!0;case Y:return!1;default:return e}}}),Xe=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||s.d,Ve=Object(s.e)(We,Xe(Object(s.a)(i.a)));a.a.render(Object(pe.jsx)(c.a,{store:Ve,children:Object(pe.jsx)(He,{})}),document.getElementById("root"))},74:function(e,t,n){}},[[150,1,2]]]);
//# sourceMappingURL=main.91d8a2fe.chunk.js.map